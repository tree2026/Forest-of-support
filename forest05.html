<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forest of Support - Healing Sanctuary</title>
    <!-- PWA Configuration - No Image Icons Needed -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#4a7c3f">
    <meta name="description" content="Forest of Support - A digital sanctuary with contextual poetic wisdom">
    <link rel="manifest" href="manifest.json?v=1.5">
    
    <!-- Emoji as Icons (No image files needed) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸŒ³</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸŒ³</text></svg>">
    
    <!-- iOS Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Forest of Support">
    
    <!-- Windows Metro Tile -->
    <meta name="msapplication-TileColor" content="#4a7c3f">
    <meta name="msapplication-config" content="none">
   
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
   
    
    <style>
    /* ==================== CSS VARIABLES ==================== */
        :root {
        /* Light theme (default - your current design) */
        --bg-gradient-start: #e6f2e6;
        --bg-gradient-end: #c9e4c9;
        --text-primary: #2d5016;
        --text-secondary: #5a7d3e;
        --card-bg: white;
        --card-border: #b8d8a8;
        --header-bg: rgba(255, 255, 255, 0.9);
        --button-bg: #4a7c3f;
        --button-shadow: #3a6530;
        --button-hover: #3a6530;
        --button-secondary: #8aae7f;
        --tree-display-bg: #f9fff9;
        --principle-bg: #e8f5e8;
        --principle-hover: #d4e8d4;
        --principle-selected: #c9e4c9;
        --textarea-border: #c9e4c9;
        --exercise-bg: #f0f7f0;
        --poem-bg-start: #f9f5e6;
        --poem-bg-end: #f5f0d9;
        --poem-border: #8a5a2d;
        --journal-bg: #f9fff9;
        --step-bg: #f9fff9;
        --step-border: #d4e8d4;
        --stat-bg: #f0f7f0;
        --stat-border: #d4e8d4;
        --footer-bg: rgba(255, 255, 255, 0.9);
        --footer-text: #5a7d3e;
        }

        [data-theme="dark"] {
    /* === COLOR VARIABLES ONLY === */
    --bg-gradient-start: #132212;
    --bg-gradient-end: #0d1a0d;
    --text-primary: #c0e2aa/*#c2e1ae #bfe2a9*/;
    --text-secondary: #819a6e;
    --text-tertiary: #405f34;
    --text-quaternary: #badba5;
    --card-bg: #1f1f1f;
    --card-border: #405f34;
    --button-bg: #194a0c;
    --button-shadow: #2d5a1d;
    --button-hover: #0a250b;
    --button-secondary: #284d1d;
    --principle-bg: #152216;
    --principle-border: #2e5b25;
    --principle-selected: #0a250b;
    --journal-bg: #2a2a2a;
    --journal-placeholder: #979797;
    --journal-date: #aeaeae;
    --poem-bg-start: #221e0d;
    --poem-bg-end: #221e0d;
    --poem-border: #724115;
    --poem-text: #c2e1ab;
    --sage-text: #a3c387;
    --exercise-outer: #1b211a;
    --exercise-inner: #182119;
    --stat-bg: #182119;
    --stat-border: #405f34;
    --stat-value: #c2e1ae;
    --progress-ring-bg: #001200;
    --footer-bg: #202020;
    --footer-text: #819a6e;
    --tree-display-bg: #182119;
    --tree-ascii-color: #c2e1ae;
    --input-bg: #2a2a2a;
    --input-border: #3b5731;
    --input-text: #ededed; 
    --input-placeholder: #979797;
        }
    
        * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Georgia', serif;
        }
    
    /* Georgian font fallback */
    .georgian-lang {
        font-family: 'Noto Sans Georgian', 'DejaVu Sans', 'BPG Nino', 'Georgia', serif;
    }
    
    body {
        background: linear-gradient(to bottom, var(--bg-gradient-start), var(--bg-gradient-end));
        color: var(--text-primary);
        min-height: 100vh;
        padding: 20px;
        line-height: 1.6;
        transition: background 0.5s ease, color 0.5s ease;
    }
    
    .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }
    
    header {
        text-align: center;
        margin-bottom: 40px;
        padding: 30px;
        background: var(--header-bg);
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border: 2px solid var(--card-border);
        transition: all 0.5s ease;
    }
    
    h1 {
        color: var(--text-primary);
        font-size: 2.8em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .tagline {
        font-style: italic;
        color: var(--text-secondary);
        font-size: 1.2em;
    }
    
    .card {
        background: var(--card-bg);
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 25px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        display: none;
        transition: all 0.5s ease;
    }
    
    .card.active {
        display: block;
        animation: fadeIn 0.5s ease;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    button {
        background: var(--button-bg);
        color: white;
        border: none;
        padding: 14px 28px;
        border-radius: 50px;
        font-size: 1.1em;
        cursor: pointer;
        transition: all 0.3s ease;
        margin: 10px 8px;
        box-shadow: 0 4px 0 var(--button-shadow);
    }
    
    button:hover {
        background: var(--button-hover);
        transform: translateY(-2px);
        box-shadow: 0 6px 0 var(--button-shadow);
    }
    
    button.secondary {
        background: var(--button-secondary);
    }
    
    .tree-display {
        text-align: center;
        font-family: 'Courier New', monospace;
        line-height: 1.2;
        margin: 25px 0;
        padding: 25px;
        background: var(--tree-display-bg);
        border-radius: 15px;
        border: 2px solid var(--card-border);
        min-height: 200px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        transition: all 0.5s ease;
    }
    
    .principle-badge {
        display: inline-block;
        background: var(--principle-bg);
        padding: 12px 20px;
        margin: 8px;
        border-radius: 25px;
        border-left: 5px solid var(--button-bg);
        width: 100%;
        text-align: left;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .principle-badge:hover {
        background: var(--principle-hover);
        transform: translateX(5px);
    }
    
    .principle-badge.selected {
        background: var(--principle-selected);
        box-shadow: 0 5px 15px rgba(74, 124, 63, 0.3);
    }
    
    textarea {
        width: 100%;
        min-height: 150px;
        padding: 20px;
        border: 2px solid var(--textarea-border);
        border-radius: 15px;
        font-size: 1.1em;
        margin: 15px 0;
        resize: vertical;
        font-family: 'Georgia', serif;
        background: var(--card-bg);
        color: var(--text-primary);
        transition: all 0.5s ease;
    }
    
    .georgian-lang textarea {
        font-family: 'Noto Sans Georgian', 'DejaVu Sans', 'BPG Nino', 'Georgia', serif;
    }
    
    .exercise-box {
        background: var(--exercise-bg);
        padding: 25px;
        margin: 20px 0;
        border-radius: 15px;
        border: 2px solid var(--card-border);
        transition: all 0.5s ease;
    }
    
    .poem-response {
        background: linear-gradient(to right, var(--poem-bg-start), var(--poem-bg-end));
        padding: 30px;
        margin: 20px 0;
        border-radius: 15px;
        border-left: 8px solid var(--poem-border);
        font-style: italic;
        line-height: 1.8;
        text-align: center;
        font-size: 1.1em;
        transition: all 0.5s ease;
    }
    
    .sage-quote {
        text-align: right;
        margin-top: 15px;
        font-style: normal;
        font-weight: bold;
        color: var(--text-secondary);
        padding-top: 15px;
        border-top: 1px dashed var(--card-border);
    }
    
    .journal-entry {
        background: var(--journal-bg);
        padding: 20px;
        margin: 15px 0;
        border-radius: 15px;
        border-left: 5px solid var(--button-bg);
        transition: all 0.5s ease;
    }
    
    .entry-date {
        color: var(--text-secondary);
        font-size: 0.9em;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
    }
    
    .step {
        padding: 25px;
        margin: 20px 0;
        background: var(--step-bg);
        border-radius: 15px;
        border: 2px solid var(--step-border);
        transition: all 0.5s ease;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 20px;
        margin: 25px 0;
    }
    
    .stat-box {
        background: var(--stat-bg);
        padding: 20px;
        border-radius: 15px;
        text-align: center;
        border: 2px solid var(--stat-border);
        transition: all 0.5s ease;
    }
    
    .stat-value {
        font-size: 2em;
        font-weight: bold;
        color: var(--button-bg);
        display: block;
    }
    
    .tree-name-display {
        font-size: 2em;
        color: var(--text-primary);
        margin: 20px 0;
        font-weight: bold;
        text-align: center;
    }
    
    .progress-ring {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: conic-gradient(var(--button-bg) 0% 25%, var(--principle-bg) 25% 100%);
        margin: 20px auto;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: var(--text-primary);
        font-size: 1.2em;
        transition: all 0.5s ease;
    }
    
    .progress-ring-inner {
        width: 90px;
        height: 90px;
        border-radius: 50%;
        background: var(--card-bg);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.5s ease;
    }
    
    footer {
        text-align: center;
        margin-top: 30px;
        padding: 10px/*25px*/;
        color: var(--footer-text);
        background: var(--footer-bg);
        border-radius: 15px;
        transition: all 0.5s ease;
    }
    
    .language-footer {
        text-align: center;
        margin: 5px 0;
        padding: 5px;
    }

    .language-toggle {
        background: var(--button-secondary);
        color: white;
        border: none;
        padding: 6px 6px/*12px*/;
        border-radius: 50px;
        font-size: 0.85em;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: bold;
    }

    .language-toggle:hover {
        background: var(--button-hover);
        transform: translateY(-2px);
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
    }
    
    /* Theme toggle button */
    .theme-toggle {
        background: var(--button-secondary);
        color: white;
        border: none;
        padding: 6px 8px/*12px*/;
        border-radius: 50px;
        font-size: 0.85em;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: bold;
        margin-left: 10px;
    }
    
    .theme-toggle:hover {
        background: var(--button-hover);
        transform: translateY(-2px);
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
    }
        
    .install-toggle {
    background: var(--button-secondary);
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 50px;
    font-size: 0.85em;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: bold;
    }

    .install-toggle:hover {
    background: var(--button-hover);
    transform: translateY(-2px);
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
    }
        
    .theme-footer {
        display: flex;
        justify-content: center;
        gap: 5px/*10px*/;
        margin: 10px 0;
    }

    /* Music toggle button */
    .music-toggle {
    visibility: visible !important;
    opacity: 1 !important;
    cursor: pointer !important;
    position: relative !important;
    z-index: 100 !important;
    background: transparent;
    border: 2px solid var(--button-bg);
    color: var(--button-bg);
    padding: 5px/*8px 12px*/;
    border-radius: 50%;
    font-size: 1.0em/*1.2em*/;
    cursor: pointer;
    /*margin-left: 5px;*/
    margin-right: 10px;
    transition: all 0.3s ease;
    width: 35px/*45px*/;
    height: 35px/*45px*/;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    /*top: -2px;*/
    vertical-align: middle;
    box-shadow: none !important; /* Remove button shadow */
    }

    .music-toggle:hover {
    background: var(--button-bg);
    color: white;
    transform: scale(1.1);
    }

    .music-toggle.playing {
    background: var(--button-bg) !important;
    color: white !important;
    animation: pulse 2s infinite !important;
    }

    @keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(74, 124, 63, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(74, 124, 63, 0); }
    100% { box-shadow: 0 0 0 0 rgba(74, 124, 63, 0); }
    }
    
    /* Canopy button  */
    #become-canopy-btn {
    background: linear-gradient(to right, #8a5a2d, #a67c52);
    box-shadow: 0 4px 0 #724115;
    }
    
    #become-canopy-btn:hover {
    background: linear-gradient(to right, #724115, #8a5a2d);
    box-shadow: 0 6px 0 #5a3410;
    }

    /* Entry footer - bottom right corner */
    .entry-footer {
    text-align: right;
    margin-top: 2px;
    padding-top: 1px;
    }
    /* Small share button */
    .small-share-btn {
    background: var(--button-secondary);
    color: white;
    border: none;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.8em;
    cursor: pointer;
    transition: all 0.2s;
    opacity: 0.8;
    }
    
    .small-share-btn:hover {
    opacity: 1;
    background: var(--button-hover);
    transform: translateY(-1px);
    }
    /* Poem share button */
    .poem-response .entry-footer {
    margin-top: 2px;
    }
    /* Remove time from date */
    .entry-date span:first-child {
    color: var(--text-secondary);
    font-size: 0.9em;
    }
    /* ==================== DARK MODE - COLOR CHANGE ONLY ==================== */

    /* === APPLY COLORS TO EXISTING STRUCTURE === */
[data-theme="dark"] #become-canopy-btn {
    background: linear-gradient(to right, #a67c52, #c9a87c);
    box-shadow: 0 4px 0 #8a5a2d;
}

[data-theme="dark"] #become-canopy-btn:hover {
    background: linear-gradient(to right, #8a5a2d, #a67c52);
    box-shadow: 0 6px 0 #724115;
}
        
[data-theme="dark"] .small-share-btn {
    background: var(--button-bg);
}
        
[data-theme="dark"] .music-toggle {
    border-color: var(--text-primary);
    color: var(--text-primary);
}

[data-theme="dark"] .music-toggle:hover {
    background: var(--button-bg);
    color: var(--text-primary);
}
        
/* Body background */
[data-theme="dark"] body {
    background: linear-gradient(to bottom, var(--bg-gradient-start), var(--bg-gradient-end));
    color: var(--text-quaternary);
}

/* Headers */
[data-theme="dark"] header {
    background: var(--card-bg);
    border-color: var(--card-border);
}

[data-theme="dark"] h1 {
    color: var(--text-primary);
}

[data-theme="dark"] .taglr(--text-secondary);
}

/* Cards */
[data-theme="dark"] .card {
    background: var(--card-bg);
}

/* Buttons */
[data-theme="dark"] button {
    background: var(--button-bg);
    box-shadow: 0 4px 0 var(--button-shadow);
}

[data-theme="dark"] button:hover {
    background: var(--button-hover);
    box-shadow: 0 6px 0 var(--button-shadow);
    transform: none; /* ADDED: Prevent movement */
}

[data-theme="dark"] button.secondary {
    background: var(--button-secondary);
}

/* Principle badges */
[data-theme="dark"] .principle-badge {
    background: var(--principle-bg);
    border-left-color: var(--principle-border);
    color: var(--text-quaternary);
}

[data-theme="dark"] .principle-badge:hover {
    background: var(--principle-bg);
    border-left-color: var(--principle-border);
    transform: translateX(5px); /* ADD BACK slight movement */
    position: relative; /* Keep for eclipse effect */
}

[data-theme="dark"] .principle-badge.selected {
    background: var(--principle-selected);
    border-left-color: var(--principle-border);
}

/* Eclipse effect - UPDATED to work with hover */
[data-theme="dark"] .principle-badge:hover::before {
    content: '';
    position: absolute;
    left: -5px;
    top: 5px;
    width: 8px;
    height: calc(100% - 10px);
    background: rgba(41, 122, 31, 0.15);
    border-radius: 2px;
}

/* Tree display */
[data-theme="dark"] .tree-display {
    background: var(--tree-display-bg);
    border-color: var(--card-border);
}

[data-theme="dark"] #treeAscii,
[data-theme="dark"] #seedPreview pre {
    color: var(--tree-ascii-color);
}

/* Textareas */
[data-theme="dark"] textarea {
    background: var(--journal-bg);
    color: var(--input-text);
    border-color: var(--input-border);
}

[data-theme="dark"] textarea::placeholder {
    color: var(--journal-placeholder);
}

/* Input fields */
[data-theme="dark"] input[type="text"] {
    background: var(--input-bg);
    color: var(--input-text);
    border-color: var(--input-border);
}

/* Input placeholder */
[data-theme="dark"] input[type="text"]::placeholder {
    color: var(--input-placeholder);
}

/* Exercise box */
[data-theme="dark"] .exercise-box {
    background: var(--exercise-outer);
    border-color: var(--card-border);
}

/* Poem response */
[data-theme="dark"] .poem-response {
    background: var(--poem-bg-start);
    border-left-color: var(--poem-border);
}

[data-theme="dark"] .poem-response p {
    color: var(--poem-text);
}

[data-theme="dark"] .sage-quote {
    color: var(--sage-text);
}

/* Journal entries */
[data-theme="dark"] .journal-entry {
    background: var(--exercise-inner);
    border-left-color: var(--principle-border);
}

[data-theme="dark"] .entry-date {
    color: var(--journal-date);
}

/* Stats boxes */
[data-theme="dark"] .stat-box {
    background: var(--stat-bg);
    border-color: var(--stat-border);
}

[data-theme="dark"] .stat-box span {
    color: var(--stat-value);
}

[data-theme="dark"] .stat-value {
    color: var(--stat-value);
}

/* Progress ring */
[data-theme="dark"] .progress-ring {
    background: conic-gradient(var(--button-bg) 0% 25%, var(--progress-ring-bg) 25% 100%) !important;
}

[data-theme="dark"] .progress-ring-inner {
    background: var(--stat-bg);
}

[data-theme="dark"] #progressText {
    color: var(--text-primary);
}

/* Step boxes */
[data-theme="dark"] .step {
    background: var(--exercise-outer);
    border-color: var(--card-border);
}

/* Footer */
[data-theme="dark"] footer {
    background: var(--footer-bg);
}

[data-theme="dark"] #footer-version,
[data-theme="dark"] #footer-data,
[data-theme="dark"] #footer-quote {
    color: var(--footer-text);
}

/* Double border focus effect */
[data-theme="dark"] input[type="text"]:focus,
[data-theme="dark"] textarea:focus {
    outline: none;
    border: 2px double;
    border-color: #e29c21 #f1d3a0;
}

/* Specific journal card background */
[data-theme="dark"] #journal.card {
    background: var(--card-bg);
}

/* Keep button color same on click */
[data-theme="dark"] button:active {
    background: var(--button-bg);
}

/* Ensure no size changes - REMOVE or KEEP? Your choice */
[data-theme="dark"] .exercise-box,
[data-theme="dark"] .principle-badge,
[data-theme="dark"] .card,
[data-theme="dark"] .step,
[data-theme="dark"] .tree-display,
[data-theme="dark"] .stat-box {
    /* These might not be needed if sizes are already correct */
    /* width: auto;
    height: auto;
    padding: inherit;
    margin: inherit; */
}
        
    @media (max-width: 768px) {
        .container {
            padding: 10px;
        }
        
        h1 {
            font-size: 2.2em;
        }

        .poem-response {
            font-size: 1.1em;
        }
        
        .stats-grid {
            grid-template-columns: 1fr 1fr;
        }
        
        /* button {
            padding: 12px 20px;
            font-size: 1em;
            margin: 5px;
        }*/
        
        .theme-footer {
            flex-direction: column;
            align-items: center;
        }
    }
        
    </style>
    
</head>
<body> 
    <div class="container">
        <header> <!--bottom of title -->
            <h1 id="app-title">
        ğŸŒ³ <span id="title-text">Forest of Support</span>
            </h1>
            <div style="position: relative; text-align: center;">
                <button id="music-toggle" class="music-toggle" aria-label="Toggle ambient sounds">
            ğŸµ
                </button>
            </div>
        </header>
        
        <!--<header>
            <h1 id="app-title">ğŸŒ³ Forest of Support</h1>
            <p class="tagline" id="app-tagline">A digital sanctuary with contextual poetic wisdom</p>
            <p id="app-subtitle">Your journal receives personalized healing poems</p>
        </header>-->
         
            
        <!-- Navigation -->

<div style="text-align: center; margin-bottom: 40px; display: flex; flex-direction: column; align-items: center; justify-content: center; flex-wrap: wrap; gap: 4px/*10px*/;">
    <button onclick="showCard('welcome')" id="nav-welcome">ğŸ  Welcome</button> 
    <button onclick="showCard('plant')" id="nav-plant">ğŸª´ Plant Tree</button>
    <button onclick="showCard('practice')" id="nav-practice">ğŸ“¿ Daily Practice</button>
    <button onclick="showCard('forest')" id="nav-forest">ğŸŒ² My Forest</button>
    <button onclick="showCard('journal')" id="nav-journal">ğŸ“– Journal</button>
</div>
        
        <!-- Welcome Card -->
        <div id="welcome" class="card active">
            <h2 id="welcome-title">Welcome to Your Digital Forest</h2>
            <p id="welcome-text">This is a safe space to practice <strong>tree-inspired healing</strong>. Your journal entries receive personalized poetic responses that reflect your words.</p>
            
            <div style="margin: 25px 0;">
                <h3 id="principles-title">ğŸŒ¿ The 8 Tree Principles</h3>
                <div id="principlesList"></div>
            </div>
            
            <p id="how-it-works"><strong>How it works:</strong> Plant your digital tree, practice daily principles, journal your reflections, and receive contextual poems that respond to your words.</p>
            
            <div style="text-align: center; margin-top: 30px;">
                <button onclick="showCard('plant')" id="start-journey-btn">Start Your Journey â†’</button>
            </div>
        </div>
        
        <!-- Plant Tree Card -->
        <div id="plant" class="card">
            <h2 id="plant-title">ğŸª´ Plant Your Digital Tree</h2>
            <p id="plant-text">Every tree starts as a seed. Name yours with intention.</p>
            
            <input type="text" id="treeName" placeholder="Enter your tree's name..." 
                   style="width: 100%; padding: 15px; margin: 20px 0; font-size: 1.2em; border: 2px solid #b8d8a8; border-radius: 10px; text-align: center;">
            
          
            <div class="tree-display" id="seedPreview">
                <pre style="font-size: 1.3em; line-height: 1.4; text-align: center;"></pre>
            </div>
           
            
            <div style="text-align: center;">
                <button onclick="plantTree()" id="plant-btn">ğŸŒ± Plant My Tree</button>
                <button class="secondary" onclick="loadDemoTree()" id="demo-btn">Try a Demo Tree</button>
            </div>
        </div>
        
        <!-- Daily Practice Card -->
        <div id="practice" class="card">
            <h2 id="practice-title">ğŸ“¿ Daily Tree Practice</h2>
            <div id="practiceStatus">Plant a tree first to begin practice.</div>
            
            <div id="practiceContent" style="display: none;">
                <!-- Step 1: Choose Principle -->
                <div class="step" id="step1">
                    <h3 id="step1-title">1. Choose Today's Principle</h3>
                    <p id="step1-text">Select one principle to focus on today:</p>
                    <div id="principleButtons"></div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button onclick="nextStep()" id="nextBtn1" disabled>Next â†’</button>
                    </div>
                </div>
                
                <!-- Step 2: Exercise -->
                <div class="step" id="step2" style="display: none;">
                    <h3 id="step2-title">2. Principle Exercise</h3>
                    <div id="exerciseContent" class="exercise-box">
                        <!-- Exercise will load here -->
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button onclick="prevStep()" id="prev-btn">â† Previous</button>
                        <button onclick="nextStep()" id="next-btn2">Complete Exercise â†’</button>
                    </div>
                </div>
                
                <!-- Step 3: Journal -->
                <div class="step" id="step3" style="display: none;">
                    <h3 id="step3-title">3. Journal Reflection</h3>
                    <p id="step3-text">Reflect on today's practice. What arose for you?</p>
                    <textarea id="practiceJournal" placeholder="Write from your heart... Your words will be met with poetic wisdom."></textarea>
                    <div style="text-align: center;">
                        <button onclick="prevStep()" id="prev-btn2">â† Previous</button>
                        <button onclick="completePractice()" id="complete-btn">Complete Practice & Receive Poem</button>
                    </div>
                </div>
            </div>
            
            <!-- Practice Result with Poem -->
            <div id="practiceResult" style="display: none;">
                <div class="poem-response">
                    <p id="poemText"></p>
                    <div class="sage-quote" id="sageQuote"></div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <p id="resultMessage" style="margin-bottom: 20px;"></p>
                    <button onclick="showCard('journal')" id="view-journal-btn">View in Journal â†’</button>
                </div>
            </div>
        </div>
        
        <!-- My Forest Card -->
        <div id="forest" class="card">
            <h2 id="forest-title">ğŸŒ² Your Digital Forest</h2>
            <div id="forestContent">
                <div class="tree-name-display" id="treeNameDisplay">
                    No tree planted yet
                </div>
                
                <div class="tree-display" id="mainTreeDisplay">
                    <pre id="treeAscii" style="font-size: 1.0em; line-height: 1.3;">Plant a tree to begin your journey</pre>
                </div>
                
                <div class="progress-ring">
                    <div class="progress-ring-inner">
                        <span id="progressText">0/5</span>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-value" id="statRings">0</span>
                        <span id="stat-rings-label">Growth Rings</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-value" id="statStage">1</span>
                        <span id="stat-stage-label">Tree Stage</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-value" id="statJournals">0</span>
                        <span id="stat-journals-label">Journal Entries</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-value" id="statPoems">0</span>
                        <span id="stat-poems-label">Poems Received</span>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button onclick="showCard('practice')" id="start-practice-btn">Start Daily Practice</button>
                    <button onclick="showCanopyCard()" id="become-canopy-btn" style="display: none;"></button>
                </div>
            </div>
        </div>
        
        <!-- Journal Card -->
        <div id="journal" class="card">
            <h2 id="journal-title">ğŸ“– Your Tree Journal</h2>
            <p id="journal-subtitle">Each entry receives a contextual poem that responds to your words.</p>
            
            <div style="margin: 25px 0;">
                <h3 id="new-entry-title">New Journal Entry</h3>
                <textarea id="newJournalEntry" placeholder="Write your thoughts, feelings, reflections... A healing poem will respond to your words."></textarea>
                <div style="text-align: center;">
                    <button onclick="saveJournalEntry()" id="save-entry-btn">Save Entry & Receive Poem</button>
                    <button class="secondary" onclick="clearJournal()" id="clear-btn">Clear Field</button>
                </div>
            </div>
            
            <div id="journalEntriesContainer">
                <h3 id="journey-title">Your Journey with Poems</h3>
                <div id="journalEntries">
                    <!-- Journal entries will appear here -->
                </div>
            </div>
        </div>
        
        <!-- Canopy Card -->
<div id="canopy" class="card">
    <h2 id="canopy-title">ğŸŒ¤ï¸ Wisdom Canopy</h2>
    <p id="canopy-subtitle">How the ancient tree offers shelter, not shadow</p>
    
    <div id="canopyStatus" style="text-align: center; padding: 20px; font-style: italic;">
        Select a canopy insight to begin practice
    </div>
    
    <!-- Step 1: Choose Canopy Insight -->
    <div id="canopyStep1" class="step" style="display: none;">
        <h3 id="canopy-step1-title">1. Choose Today's Canopy Wisdom</h3>
        <p id="canopy-step1-text">Select one canopy insight to reflect on:</p>
        <div id="canopyButtons"></div>
        <div style="text-align: center; margin-top: 20px;">
            <button onclick="canopyNextStep()" id="canopyNextBtn1" disabled>Next â†’</button>
        </div>
    </div>
    
    <!-- Step 2: Practice Insight -->
    <div id="canopyStep2" class="step" style="display: none;">
        <h3 id="canopy-step2-title">2. Practice Insight</h3>
        <div id="canopyExerciseContent" class="exercise-box">
        </div>
        <div style="text-align: center; margin-top: 20px;">
            <button onclick="canopyPrevStep()" id="canopyPrevBtn">â† Previous</button>
            <button onclick="canopyNextStep()" id="canopyNextBtn2">Next â†’</button>
        </div>
    </div>
    
    <!-- Step 3: Write Offering Response -->
    <div id="canopyStep3" class="step" style="display: none;">
        <h3 id="canopy-step3-title">3. Write Your Offering</h3>
        <p id="canopy-step3-text">Reflect on the practice. What will you offer?</p>
        <textarea id="canopyJournal" placeholder="Write your response here..."></textarea>
    <div id="canopyOfferingDisplay" style="font-style: italic; color: var(--text-secondary);">
    </div>
        <div style="text-align: center;">
            <button onclick="canopyPrevStep()" id="canopyPrevBtn2">â† Previous</button>
            <button onclick="completeCanopyPractice()" id="canopyCompleteBtn">Complete Practice</button>
        </div>
    </div>
    
    <!-- Canopy Practice Result -->
    <div id="canopyResult" style="display: none;">
        <div class="poem-response">
            <p id="canopyResultMessage"></p>
            <div class="sage-quote" id="canopySageQuote"></div>
        </div>
        
        <div style="text-align: center; margin-top: 30px;">
            <button onclick="showJournalAndScrollToNewest()" id="canopyViewJournalBtn">View in Journal</button>
            <button onclick="resetCanopyPractice()" class="secondary">New Practice</button>
        </div>
    </div>
</div>
   
       <!-- Replace your current footer -->
<footer>
   <!-- <div style="text-align: center; margin: 10px 0;"> -->
       <!-- <button class="language-toggle" onclick="toggleLanguage()" id="lang-toggle">ğŸŒ ENG/GE</button> -->
   <!-- </div> -->
    <div class="theme-footer">
        <button class="language-toggle" onclick="toggleLanguage()" id="lang-toggle">ğŸŒ ENG/GE</button>
        <button class="theme-toggle" onclick="toggleTheme()" id="theme-toggle">ğŸŒ™</button>
    </div>
    
    <p id="footer-version">ğŸŒ¿ Forest of Support v1.5 â€¢ Digital Healing Sanctuary</p>
    <p id="footer-creator">Created by DeepSeek & Geoni</p>
    <p id="footer-data">Your data stays in your browser â€¢ Share with #ForestOfSupport #HealLikeATree</p>
    <p>
    <a href="https://www.amazon.com/Angels-play-Demons-jouant-D%C3%A9mons/dp/B0DP8V2C8Y" 
       target="_blank"
       style="color: var(--text-secondary); text-decoration: underline;">
       <span id="footer-book">Geoni's Book</span>
    </a>
    </p>
    <p id="footer-quote"><em>"The wound is where the light enters you." - Rumi</em></p>
        
        <button class="install-toggle" onclick="promptInstall()" id="install-btn" style="display: none;">
           ğŸ“± <span id="install-text">Install App</span>
        </button>
</footer> 
    </div>

    <!-- poems data 1.0 -->
    <script src="poems-data.js?v=1.0"></script>
    
    <script>
        // Forest of Support - Bilingual v1.2
        // 144 poems in both English and Georgian
        
        // APP CONFIG
        const APP_VERSION = '1.5';
        const VERSION_KEY = 'forestAppVersion';
        const LANG_KEY = 'forestLanguage';
        
        // Replace the removed objects with these references:
        const poeticWisdom = window.POETIC_WISDOM_EXPORT;
        const canopyWisdom = window.CANOPY_WISDOM_EXPORT;
        
        // Language state
        let currentLanguage = 'en'; // 'en' or 'ge'
        
        // Tree data
        let myTree = {
            name: "",
            plantedDate: "",
            rings: 0,
            stage: 1,
            journals: [],
            practices: [],
            poemsReceived: 0,
            lastPracticePrinciple: null,
            poemUsage: {},
            shownPoemsByCategory: {
                rooting: [], bark: [], rings: [], release: [], reaching: [],
                network: [], bending: [], shape: [], seasons: [], wholeness: [],
                patience: [], presence: []
            }
        };
        
        let currentStep = 1;
        let selectedPrinciple = null;
        let canopyCurrentStep = 1;
        let selectedCanopyInsight = null;
        
        // ==================== BILINGUAL CONTENT ====================
        
        const TEXT = {
            en: {
                // Navigation
                navWelcome: "ğŸ  Welcome",
                navPlant: "ğŸª´ Plant Tree",
                navPractice: "ğŸ“¿ Daily Practice",
                navForest: "ğŸŒ² My Forest",
                navJournal: "ğŸ“– Journal",
                
                // App titles
                appTitle: "ğŸŒ³ Forest of Support",
                appTagline: "A digital sanctuary with contextual poetic wisdom",
                appSubtitle: "Your journal receives personalized healing poems",
                
                // Welcome card
                welcomeTitle: "Welcome to Your Digital Forest",
                welcomeText: "This is a safe space to practice <strong>tree-inspired healing</strong>. Your journal entries receive personalized poetic responses that reflect your words.",
                principlesTitle: "ğŸŒ¿ The 8 Tree Principles",
                howItWorks: "<strong>How it works:</strong> Plant your digital tree, practice daily principles, journal your reflections, and receive contextual poems that respond to your words.",
                startJourneyBtn: "Start Your Journey â†’",
                
                // Plant tree card
                plantTitle: "ğŸª´ Plant Your Digital Tree",
                plantText: "Every tree starts as a seed. Name yours with intention.",
                treeNamePlaceholder: "Enter your tree's name...",
                plantBtn: "ğŸŒ± Plant My Tree",
                demoBtn: "Try a Demo Tree",
                
                // Practice card
                practiceTitle: "ğŸ“¿ Daily Tree Practice",
                practiceStatus: "Plant a tree first to begin practice.",
                step1Title: "1. Choose Today's Principle",
                step1Text: "Select one principle to focus on today:",
                step2Title: "2. Principle Exercise",
                step3Title: "3. Journal Reflection",
                step3Text: "Reflect on today's practice. What arose for you?",
                practiceJournalPlaceholder: "Write from your heart... Your words will be met with poetic wisdom.",
                nextBtn: "Next â†’",
                prevBtn: "â† Previous",
                completeBtn: "Complete Practice & Receive Poem",
                viewJournalBtn: "View in Journal â†’",
                
                // Forest card
                forestTitle: "ğŸŒ² Your Digital Forest",
                noTree: "No tree planted yet",
                plantToBegin: "Plant a tree to begin your journey",
                startPracticeBtn: "Start Daily Practice",
                statRingsLabel: "Growth Rings",
                statStageLabel: "Tree Stage",
                statJournalsLabel: "Journal Entries",
                statPoemsLabel: "Poems Received",
                
                // Canopy 
                canopyTitle: "ğŸŒ¤ï¸ Wisdom Canopy",
                canopySubtitle: "How the ancient tree offers shelter, not shadow",
                canopyCompleteBtn: "Complete Practice",
                becomeCanopyBtn: "ğŸŒ¤ï¸ Become Canopy",
                canopyStep1Title: "1. Choose Today's Canopy Wisdom",
                canopyStep1Text: "Select one canopy insight to reflect on:",
                canopyStep2Title: "2. Practice Insight", 
                canopyStep3Title: "3. Write Your Offering",
                canopyStep3Text: "Reflect on the practice. What will you offer?",
                canopyJournalPlaceholder: "Write your response here...",
                
                // Journal card
                journalTitle: "ğŸ“– Your Tree Journal",
                journalSubtitle: "Each entry receives a contextual poem that responds to your words.",
                newEntryTitle: "New Journal Entry",
                journalPlaceholder: "Write your thoughts, feelings, reflections... A healing poem will respond to your words.",
                saveEntryBtn: "Save Entry & Receive Poem",
                clearBtn: "Clear Field",
                journeyTitle: "Your Journey with Poems",
                noEntries: "No journal entries yet.<br>Your reflections will appear here with poetic responses.",
                
                // Footer
                languageLabel: "Language / áƒ”áƒœáƒ:",
                currentLang: "Current: English",
                footerVersion: "ğŸŒ¿ Forest of Support v1.5 â€¢ Digital Healing Sanctuary",
                footerData: "Your data stays in your browser â€¢ Share with #ForestOfSupport #HealLikeATree",
                footerQuote: "\"The wound is where the light enters you.\" - Rumi",
                footerCreator: "Created by DeepSeek & Geoni",
                footerBook: "Geoni's Book",
                
                // Alerts and messages
                alertNameTree: "Please name your tree first.",
                alertTreePlanted: "ğŸŒ³ {name} has been planted!",
                alertSelectPrinciple: "Please select a principle first.",
                alertWriteJournal: "Please write a journal reflection before completing.",
                alertPlantFirst: "Please plant a tree first.",
                alertWriteSomething: "Please write something first.",
                
                // Result messages
                practiceComplete: "âœ… Practice complete!<br><strong>Principle:</strong> {principle}<br><strong>New growth ring added</strong><br><small>Your tree is now at stage {stage}</small>",
                
                // Add this line with the other navigation/text:
                installBtn: "Install App",
                
                // Update message
                updateTitle: "ğŸ“‹ Update v{version}",
                // updateNewPoem: "<strong>New Poem System:</strong>",
                // updateList: "<li>Share button added in journal</li><li>Canopy button added in MyForest after 21 rings</li>",
                updatePreserved: "Your existing journal entries and tree progress are preserved."
            },
            
            ge: {
                // Navigation
                navWelcome: "ğŸ  áƒ›áƒ˜áƒ¡áƒáƒ¡áƒáƒšáƒ›áƒ”áƒ‘áƒ”áƒšáƒ˜",
                navPlant: "ğŸª´ áƒ®áƒ˜áƒ¡ áƒ“áƒáƒ áƒ’áƒ•áƒ",
                navPractice: "ğŸ“¿ áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜ áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ˜",
                navForest: "ğŸŒ² áƒ©áƒ”áƒ›áƒ˜ áƒ¢áƒ§áƒ”",
                navJournal: "ğŸ“– áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜",
                
                // App titles
                appTitle: "ğŸŒ³ áƒ›áƒ®áƒáƒ áƒ“áƒáƒ­áƒ”áƒ áƒ˜áƒ¡ áƒ¢áƒ§áƒ”",
                appTagline: "áƒ®áƒ˜áƒ¡ áƒ¢áƒáƒ«áƒáƒ áƒ¨áƒ˜ áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒªáƒ˜áƒ¤áƒ áƒ£áƒšáƒ˜ áƒ—áƒáƒ•áƒ¨áƒ”áƒ¡áƒáƒ¤áƒáƒ áƒ˜",
                appSubtitle: "áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ¨áƒ˜ áƒ›áƒ˜áƒ˜áƒ¦áƒ”áƒ‘áƒ— áƒ¡áƒáƒ›áƒ™áƒ£áƒ áƒœáƒáƒšáƒ áƒšáƒ”áƒ¥áƒ¡áƒ¡",
                
                // Welcome card
                welcomeTitle: "áƒ™áƒ”áƒ—áƒ˜áƒšáƒ˜ áƒ˜áƒ§áƒáƒ¡ áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ›áƒáƒ‘áƒ áƒ«áƒáƒœáƒ”áƒ‘áƒ áƒªáƒ˜áƒ¤áƒ áƒ£áƒš áƒ¢áƒ§áƒ”áƒ¨áƒ˜",
                welcomeText: "áƒ”áƒ¡ áƒ£áƒ¡áƒáƒ¤áƒ áƒ—áƒ®áƒ áƒ¡áƒ˜áƒ•áƒ áƒªáƒ”áƒ <strong>áƒ®áƒ˜áƒ¡áƒ’áƒáƒœ áƒ¨áƒ—áƒáƒ’áƒáƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ’áƒáƒœáƒ™áƒ£áƒ áƒœáƒ”áƒ‘áƒ˜áƒ¡</strong> áƒáƒ áƒáƒ¥áƒ¢áƒ˜áƒ™áƒáƒ¨áƒ˜ áƒ’áƒáƒ›áƒáƒ¡áƒáƒ§áƒ”áƒœáƒ”áƒ‘áƒšáƒáƒ“. áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜áƒ¡ áƒ©áƒáƒœáƒáƒ¬áƒ”áƒ áƒ”áƒ‘áƒ–áƒ” áƒ›áƒ˜áƒ˜áƒ¦áƒ”áƒ‘áƒ— áƒáƒ”áƒ áƒ¡áƒáƒœáƒáƒšáƒ˜áƒ–áƒ”áƒ‘áƒ£áƒš áƒáƒáƒ”áƒ¢áƒ£áƒ  áƒáƒáƒ¡áƒ£áƒ®áƒ”áƒ‘áƒ¡, áƒ áƒáƒ›áƒšáƒ”áƒ‘áƒ˜áƒª áƒáƒ¡áƒáƒ®áƒáƒ•áƒ¡ áƒ—áƒ¥áƒ•áƒ”áƒœáƒ¡ áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ”áƒ‘áƒ¡ áƒ“áƒ áƒ¡áƒ˜áƒ¢áƒ§áƒ•áƒ”áƒ‘áƒ¡.",
                principlesTitle: "ğŸŒ¿ áƒ®áƒ˜áƒ¡ 8 áƒáƒ áƒ˜áƒœáƒªáƒ˜áƒáƒ˜",
                howItWorks: "<strong>áƒ áƒáƒ’áƒáƒ  áƒ›áƒ£áƒ¨áƒáƒáƒ‘áƒ¡:</strong> áƒ“áƒáƒ áƒ’áƒ”áƒ— áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒªáƒ˜áƒ¤áƒ áƒ£áƒšáƒ˜ áƒ®áƒ”, áƒ˜áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ”áƒ— áƒ§áƒáƒ•áƒ”áƒšáƒ“áƒ¦áƒ˜áƒ£áƒ áƒáƒ“, áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ¨áƒ˜ áƒ©áƒáƒ˜áƒ¬áƒ”áƒ áƒ”áƒ— áƒ¤áƒ˜áƒ¥áƒ áƒ”áƒ‘áƒ˜ áƒ“áƒ áƒ›áƒ˜áƒ˜áƒ¦áƒ”áƒ— áƒ¨áƒ”áƒ¡áƒáƒ‘áƒáƒ›áƒ˜áƒ¡áƒ˜ áƒšáƒ”áƒ¥áƒ¡áƒ”áƒ‘áƒ˜, áƒ áƒáƒ›áƒšáƒ”áƒ‘áƒ˜áƒª áƒ—áƒ¥áƒ•áƒ”áƒœáƒ¡ áƒ¡áƒ˜áƒ¢áƒ§áƒ•áƒ”áƒ‘áƒ¡ áƒ”áƒ®áƒ›áƒ˜áƒáƒœáƒ”áƒ‘áƒ",
                startJourneyBtn: "áƒ“áƒáƒ˜áƒ¬áƒ§áƒ” áƒ›áƒáƒ’áƒ–áƒáƒ£áƒ áƒáƒ‘áƒ â†’",
                
                // Plant tree card
                plantTitle: "ğŸª´ áƒ“áƒáƒ áƒ’áƒ”áƒ— áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒªáƒ˜áƒ¤áƒ áƒ£áƒšáƒ˜ áƒ®áƒ”",
                plantText: "áƒ§áƒáƒ•áƒ”áƒšáƒ˜ áƒ®áƒ” áƒ—áƒ”áƒ¡áƒšáƒ˜áƒ— áƒ˜áƒ¬áƒ§áƒ”áƒ‘áƒ. áƒ¡áƒáƒ®áƒ”áƒšáƒ˜ áƒ®áƒ”áƒ¡ áƒ’áƒáƒœáƒ–áƒ áƒáƒ®áƒ•áƒ˜áƒ— áƒ“áƒáƒáƒ áƒ¥áƒ•áƒ˜áƒ—.",
                treeNamePlaceholder: "áƒ®áƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜...",
                plantBtn: "ğŸŒ± áƒ“áƒáƒ•áƒ áƒ’áƒ áƒ©áƒ”áƒ›áƒ˜ áƒ®áƒ”",
                demoBtn: "áƒ•áƒªáƒáƒ“áƒ áƒ¡áƒáƒ©áƒ•áƒ”áƒœáƒ”áƒ‘áƒ”áƒšáƒ˜ áƒ®áƒ”",
                
                // Practice card
                practiceTitle: "ğŸ“¿ áƒ®áƒ˜áƒ¡ áƒ§áƒáƒ•áƒ”áƒšáƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜ áƒ¡áƒáƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ",
                practiceStatus: "áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ˜áƒ¡ áƒ“áƒáƒ¡áƒáƒ¬áƒ§áƒ”áƒ‘áƒáƒ“ áƒ¯áƒ”áƒ  áƒ®áƒ” áƒ“áƒáƒ áƒ’áƒ”áƒ—.",
                step1Title: "1. áƒáƒ˜áƒ áƒ©áƒ˜áƒ”áƒ— áƒ“áƒ¦áƒ”áƒ•áƒáƒœáƒ“áƒ”áƒšáƒ˜ áƒáƒ áƒ˜áƒœáƒªáƒ˜áƒáƒ˜",
                step1Text: "áƒáƒ˜áƒ áƒ©áƒ˜áƒ”áƒ— áƒ”áƒ áƒ—áƒ˜ áƒáƒ áƒ˜áƒœáƒªáƒ˜áƒáƒ˜, áƒ áƒáƒ›áƒ”áƒšáƒ–áƒ”áƒª áƒ“áƒ¦áƒ”áƒ¡ áƒ§áƒ£áƒ áƒáƒ“áƒ¦áƒ”áƒ‘áƒáƒ¡ áƒ’áƒáƒáƒ›áƒáƒ®áƒ•áƒ˜áƒšáƒ”áƒ‘áƒ—:",
                step2Title: "2. áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ˜",
                step3Title: "3. áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ¨áƒ˜ áƒáƒ¡áƒáƒ®áƒ•áƒ",
                step3Text: "áƒ“áƒáƒ¤áƒ˜áƒ¥áƒ áƒ“áƒ˜áƒ— áƒ“áƒ¦áƒ”áƒ•áƒáƒœáƒ“áƒ”áƒš áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ–áƒ”. áƒ áƒ áƒ’áƒáƒ›áƒáƒ’áƒ˜áƒ•áƒ˜áƒ“áƒáƒ—?",
                practiceJournalPlaceholder: "áƒ“áƒáƒ¬áƒ”áƒ áƒ”áƒ— áƒ’áƒ£áƒšáƒ˜áƒ“áƒáƒœ... áƒ¡áƒ˜áƒ‘áƒ áƒ«áƒœáƒ” áƒáƒáƒ”áƒ¢áƒ£áƒ áƒáƒ“ áƒ’áƒ˜áƒáƒáƒ¡áƒ£áƒ®áƒ”áƒ‘áƒ—.",
                nextBtn: "áƒ¨áƒ”áƒ›áƒ“áƒ”áƒ’áƒ˜ â†’",
                prevBtn: "â† áƒ¬áƒ˜áƒœáƒ",
                completeBtn: "áƒ“áƒáƒáƒ¡áƒ áƒ£áƒšáƒ”áƒ— áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ˜ áƒ“áƒ áƒ›áƒ˜áƒ˜áƒ¦áƒ”áƒ— áƒšáƒ”áƒ¥áƒ¡áƒ˜",
                viewJournalBtn: "áƒ˜áƒ®áƒ˜áƒšáƒ”áƒ— áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ¨áƒ˜ â†’",
                
                // Forest card
                forestTitle: "ğŸŒ² áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒªáƒ˜áƒ¤áƒ áƒ£áƒšáƒ˜ áƒ¢áƒ§áƒ”",
                noTree: "áƒ¯áƒ”áƒ  áƒáƒ áƒªáƒ”áƒ áƒ—áƒ˜ áƒ®áƒ”áƒ áƒ“áƒáƒ áƒ’áƒ£áƒšáƒ˜",
                plantToBegin: "áƒ“áƒáƒ áƒ’áƒ”áƒ— áƒ®áƒ” áƒ›áƒáƒ’áƒ–áƒáƒ£áƒ áƒáƒ‘áƒ˜áƒ¡ áƒ“áƒáƒ¡áƒáƒ¬áƒ§áƒ”áƒ‘áƒáƒ“",
                startPracticeBtn: "áƒ“áƒáƒ˜áƒ¬áƒ§áƒ”áƒ— áƒ§áƒáƒ•áƒ”áƒšáƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜ áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ˜",
                statRingsLabel: "áƒ–áƒ áƒ“áƒ˜áƒ¡ áƒ áƒ’áƒáƒšáƒ˜",
                statStageLabel: "áƒ®áƒ˜áƒ¡ áƒ¡áƒ¢áƒáƒ“áƒ˜áƒ",
                statJournalsLabel: "áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜áƒ¡ áƒ©áƒáƒœáƒáƒ¬áƒ”áƒ áƒ˜",
                statPoemsLabel: "áƒ›áƒ˜áƒ¦áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒšáƒ”áƒ¥áƒ¡áƒ˜",
                
                // Canopy
                canopyTitle: "ğŸŒ¤ï¸ áƒ¡áƒáƒ©áƒ áƒ“áƒ˜áƒšáƒáƒ‘áƒ”áƒšáƒ˜",
                canopySubtitle: "áƒ‘áƒ”áƒ‘áƒ”áƒ áƒ˜ áƒ®áƒ” áƒ—áƒáƒ•áƒ¨áƒ”áƒ¡áƒáƒ¤áƒáƒ áƒ¡ áƒ’áƒ•áƒ—áƒáƒ•áƒáƒ–áƒáƒ‘áƒ¡, áƒ›áƒ®áƒáƒšáƒáƒ“ áƒ©áƒ áƒ“áƒ˜áƒšáƒ¡ áƒ™áƒ˜ áƒáƒ áƒ",
                canopyCompleteBtn: "áƒ“áƒáƒáƒ¡áƒ áƒ£áƒšáƒ”áƒ— áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ˜",
                becomeCanopyBtn: "ğŸŒ¤ï¸ áƒ¡áƒáƒ©áƒ áƒ“áƒ˜áƒšáƒáƒ‘áƒ”áƒšáƒ˜",
                canopyStep1Title: "1. áƒ“áƒ¦áƒ”áƒ•áƒáƒœáƒ“áƒ”áƒšáƒ˜ áƒ¡áƒáƒ©áƒ áƒ“áƒ˜áƒšáƒáƒ‘áƒ”áƒšáƒ˜",
                canopyStep1Text: "áƒáƒ˜áƒ áƒ©áƒ˜áƒ”áƒ— áƒ”áƒ áƒ—áƒ˜ áƒ¨áƒ”áƒ®áƒ”áƒ“áƒ£áƒšáƒ”áƒ‘áƒ, áƒ áƒáƒ›áƒ”áƒšáƒ–áƒ”áƒª áƒ“áƒáƒ¤áƒ˜áƒ¥áƒ áƒ“áƒ”áƒ‘áƒ˜áƒ—:",
                canopyStep2Title: "2. áƒ¨áƒ”áƒ®áƒ”áƒ“áƒ£áƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ¡áƒáƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ",
                canopyStep3Title: "3. áƒ¨áƒ”áƒ¡áƒáƒ¬áƒ˜áƒ áƒ˜ áƒ¬áƒ”áƒ áƒ˜áƒšáƒ˜",
                canopyStep3Text: "áƒ“áƒáƒ¤áƒ˜áƒ¥áƒ áƒ“áƒ˜áƒ— áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ–áƒ”. áƒ áƒ áƒ˜áƒ¥áƒœáƒ”áƒ‘áƒ áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ¬áƒ•áƒšáƒ˜áƒšáƒ˜?",
                canopyJournalPlaceholder: "áƒ“áƒáƒ¬áƒ”áƒ áƒ”áƒ— áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒáƒáƒ¡áƒ£áƒ®áƒ˜ áƒáƒ¥...",
                
                // Journal card
                journalTitle: "ğŸ“– áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ®áƒ˜áƒ¡ áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜",
                journalSubtitle: "áƒ—áƒ˜áƒ—áƒáƒ”áƒ£áƒš áƒ©áƒáƒœáƒáƒ¬áƒ”áƒ áƒ¡ áƒ›áƒáƒ°áƒ§áƒ•áƒ”áƒ‘áƒ áƒ¨áƒ”áƒ¡áƒáƒ‘áƒáƒ›áƒ˜áƒ¡áƒ˜ áƒšáƒ”áƒ¥áƒ¡áƒ˜, áƒ áƒáƒ›áƒ”áƒšáƒ˜áƒª áƒ—áƒ¥áƒ•áƒ”áƒœáƒ¡ áƒ¡áƒ˜áƒ¢áƒ§áƒ•áƒ”áƒ‘áƒ¡ áƒ“áƒ áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ”áƒ‘áƒ¡ áƒ”áƒ®áƒ›áƒáƒ£áƒ áƒ”áƒ‘áƒ.",
                newEntryTitle: "áƒáƒ®áƒáƒšáƒ˜ áƒ©áƒáƒœáƒáƒ¬áƒ”áƒ áƒ˜",
                journalPlaceholder: "áƒ“áƒáƒ¬áƒ”áƒ áƒ”áƒ— áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒáƒ–áƒ áƒ”áƒ‘áƒ˜, áƒ’áƒ áƒ«áƒœáƒáƒ‘áƒ”áƒ‘áƒ˜, áƒ¤áƒ˜áƒ¥áƒ áƒ”áƒ‘áƒ˜... áƒ¡áƒáƒ›áƒ™áƒ£áƒ áƒœáƒáƒšáƒ áƒšáƒ”áƒ¥áƒ¡áƒ˜ áƒ’áƒ˜áƒáƒáƒ¡áƒ£áƒ®áƒ”áƒ‘áƒ—.",
                saveEntryBtn: "áƒ¨áƒ”áƒ˜áƒœáƒáƒ®áƒ”áƒ— áƒ©áƒáƒœáƒáƒ¬áƒ”áƒ áƒ˜ áƒ“áƒ áƒ›áƒ˜áƒ˜áƒ¦áƒ”áƒ— áƒšáƒ”áƒ¥áƒ¡áƒ˜",
                clearBtn: "áƒ•áƒ”áƒšáƒ˜áƒ¡ áƒ’áƒáƒ¡áƒ£áƒ¤áƒ—áƒáƒ•áƒ”áƒ‘áƒ",
                journeyTitle: "áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ›áƒáƒ’áƒ–áƒáƒ£áƒ áƒáƒ‘áƒ áƒšáƒ”áƒ¥áƒ¡áƒ”áƒ‘áƒ—áƒáƒœ áƒ”áƒ áƒ—áƒáƒ“",
                noEntries: "áƒ¯áƒ”áƒ  áƒáƒ  áƒáƒ áƒ˜áƒ¡ áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜áƒ¡ áƒ©áƒáƒœáƒáƒ¬áƒ”áƒ áƒ˜.<br>áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜ áƒ’áƒáƒ›áƒáƒ©áƒœáƒ“áƒ”áƒ‘áƒ áƒáƒ¥ áƒáƒáƒ”áƒ¢áƒ£áƒ áƒ˜ áƒáƒáƒ¡áƒ£áƒ®áƒ”áƒ‘áƒ˜áƒ—.",
                
                // Footer
                languageLabel: "Language / áƒ”áƒœáƒ:",
                currentLang: "áƒ›áƒ˜áƒ›áƒ“áƒ˜áƒœáƒáƒ áƒ”: áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜",
                footerVersion: "ğŸŒ¿ áƒ›áƒ®áƒáƒ áƒ“áƒáƒ­áƒ”áƒ áƒ˜áƒ¡ áƒ¢áƒ§áƒ” v1.5 â€¢ áƒ›áƒ™áƒ£áƒ áƒœáƒáƒšáƒ˜ áƒ®áƒ˜áƒ¡ áƒªáƒ˜áƒ¤áƒ áƒ£áƒšáƒ˜ áƒáƒ—áƒáƒ®áƒ˜",
                footerData: "áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜ áƒ áƒ©áƒ”áƒ‘áƒ áƒ—áƒ¥áƒ•áƒ”áƒœáƒ¡ áƒ‘áƒ áƒáƒ£áƒ–áƒ”áƒ áƒ¨áƒ˜ â€¢ áƒ’áƒáƒáƒ–áƒ˜áƒáƒ áƒ”áƒ— #ForestOfSupport #HealLikeATree",
                footerQuote: "\"áƒ­áƒ áƒ˜áƒšáƒáƒ‘áƒ áƒ˜áƒ¥ áƒáƒ áƒ˜áƒ¡, áƒ¡áƒáƒ“áƒáƒª áƒ¡áƒ˜áƒœáƒáƒ—áƒšáƒ” áƒ¨áƒ”áƒ›áƒáƒ“áƒ˜áƒ¡.\" - áƒ áƒ£áƒ›áƒ˜",
                footerCreator: "DeepSeek-áƒ˜áƒ¡ áƒ“áƒ áƒ¯áƒ”áƒáƒœáƒ˜áƒ¡áƒ’áƒáƒœ",
                footerBook: "áƒ¯áƒ”áƒáƒœáƒ˜áƒ¡ áƒ¬áƒ˜áƒ’áƒœáƒ˜", 
                
                // Alerts and messages
                alertNameTree: "áƒ¯áƒ”áƒ  áƒ¡áƒáƒ®áƒ”áƒšáƒ˜ áƒ“áƒáƒáƒ áƒ¥áƒ•áƒ˜áƒ— áƒ®áƒ”áƒ¡.",
                alertTreePlanted: "ğŸŒ³ {name} áƒ“áƒáƒ áƒ’áƒ£áƒšáƒ˜áƒ!",
                alertSelectPrinciple: "áƒ¯áƒ”áƒ  áƒáƒ˜áƒ áƒ©áƒ˜áƒ”áƒ— áƒáƒ áƒ˜áƒœáƒªáƒ˜áƒáƒ˜.",
                alertWriteJournal: "áƒ“áƒáƒ¡áƒáƒ¡áƒ áƒ£áƒšáƒ”áƒ‘áƒšáƒáƒ“ áƒ¯áƒ”áƒ  áƒ“áƒáƒ¬áƒ”áƒ áƒ”áƒ— áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ¨áƒ˜.",
                alertPlantFirst: "áƒ¯áƒ”áƒ  áƒ“áƒáƒ áƒ’áƒ”áƒ— áƒ®áƒ”.",
                alertWriteSomething: "áƒ¯áƒ”áƒ  áƒ“áƒáƒ¬áƒ”áƒ áƒ”áƒ— áƒ áƒáƒ›áƒ”.",
                
                // Result messages
                practiceComplete: "âœ… áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ˜ áƒ“áƒáƒ¡áƒ áƒ£áƒšáƒ“áƒ!<br><strong>áƒáƒ áƒ˜áƒœáƒªáƒ˜áƒáƒ˜:</strong> {principle}<br><strong>áƒ“áƒáƒ”áƒ›áƒáƒ¢áƒ áƒáƒ®áƒáƒšáƒ˜ áƒ–áƒ áƒ“áƒ˜áƒ¡ áƒ áƒ’áƒáƒšáƒ˜</strong><br><small>áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ®áƒ” áƒáƒ®áƒšáƒ {stage} áƒ“áƒáƒœáƒ”áƒ–áƒ”áƒ</small>",
                
                // Add this line:
                installBtn: "áƒáƒáƒšáƒ˜áƒ™áƒáƒªáƒ˜áƒ˜áƒ¡ áƒ“áƒáƒ§áƒ”áƒœáƒ”áƒ‘áƒ",  
                
                // Update message
                updateTitle: "ğŸ“‹ áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ v{version}",
               // updateNewPoem: "<strong>áƒáƒ®áƒáƒšáƒ˜ áƒáƒáƒ”áƒ›áƒ˜áƒ¡ áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ:</strong>",
               // updateList: "<li>áƒ“áƒáƒ”áƒ›áƒáƒ¢áƒ áƒ’áƒáƒ–áƒ˜áƒáƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ¦áƒ˜áƒšáƒáƒ™áƒ˜ áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ¨áƒ˜</li><li>áƒ“áƒáƒ”áƒ›áƒáƒ¢áƒ áƒ¡áƒáƒ©áƒ áƒ“áƒ˜áƒšáƒáƒ‘áƒ”áƒšáƒ˜ 21 áƒ áƒ’áƒáƒšáƒ˜áƒ“áƒáƒœ áƒ©áƒ”áƒ›áƒ¡ áƒ¢áƒ§áƒ”áƒ¨áƒ˜</li>",
                updatePreserved: "áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒáƒ áƒ¡áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜áƒ¡ áƒ©áƒáƒœáƒáƒ¬áƒ”áƒ áƒ”áƒ‘áƒ˜ áƒ“áƒ áƒ®áƒ˜áƒ¡ áƒáƒ áƒáƒ’áƒ áƒ”áƒ¡áƒ˜ áƒ¨áƒ”áƒœáƒáƒ áƒ©áƒ£áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜áƒ."
            }
        };
        
        // ==================== BILINGUAL PRINCIPLES ====================
        
        const principlesData = {
            en: [
                {
                    id: "root",
                    title: "Root First",
                    emoji: "ğŸŒ±",
                    description: "Ground before responding",
                    exercise: `
                        <h4>ğŸŒ± Rooting Exercise (3 minutes)</h4>
                        <p>1. Stand or sit with feet flat on the ground</p>
                        <p>2. Close your eyes and place hands on your belly</p>
                        <p>3. Inhale for 4 counts: imagine roots growing deep into earth</p>
                        <p>4. Exhale for 6 counts: release tension into the ground</p>
                        <p>5. Repeat: "I am grounded. I am present."</p>
                        <p><em>Feel your connection to the earth supporting you.</em></p>
                    `
                },
                {
                    id: "bark",
                    title: "Bark Boundaries",
                    emoji: "ğŸ›¡ï¸",
                    description: "Protect while staying open",
                    exercise: `
                        <h4>ğŸ›¡ï¸ Boundary Visualization (3 minutes)</h4>
                        <p>1. Close your eyes and visualize a protective energy field</p>
                        <p>2. Imagine it as tree bark: strong but permeable</p>
                        <p>3. Set the intention: "I allow in what nourishes me"</p>
                        <p>4. "I filter out what drains me"</p>
                        <p>5. Feel this boundary as flexible yet firm</p>
                        <p><em>Healthy boundaries are loving, not walls.</em></p>
                    `
                },
                {
                    id: "rings",
                    title: "Grow Rings",
                    emoji: "ğŸ‹",
                    description: "Every experience adds strength",
                    exercise: `
                        <h4>ğŸ‹ Growth Ring Meditation (3 minutes)</h4>
                        <p>1. Place a hand on your heart</p>
                        <p>2. Recall a recent experience, challenging or joyful</p>
                        <p>3. Breathe into it: "This becomes part of my strength"</p>
                        <p>4. Visualize it forming a new ring in your core</p>
                        <p>5. Thank it for making you who you are</p>
                        <p><em>Every ring, thick or thin, contributes to your wholeness.</em></p>
                    `
                },
                {
                    id: "release",
                    title: "Seasonal Release",
                    emoji: "ğŸ‚",
                    description: "Let go of what no longer serves",
                    exercise: `
                        <h4>ğŸ‚ Letting Go Ritual (3 minutes)</h4>
                        <p>1. Bring to mind something you're ready to release</p>
                        <p>2. Write it mentally on an autumn leaf</p>
                        <p>3. Breathe deeply and visualize the leaf falling</p>
                        <p>4. Watch it drift gently to the ground</p>
                        <p>5. Say: "I release you with love. I make space for new growth."</p>
                        <p><em>Letting go is an act of trust in the cycle.</em></p>
                    `
                },
                {
                    id: "light",
                    title: "Reach for Light",
                    emoji: "â˜€ï¸",
                    description: "Grow toward nourishment",
                    exercise: `
                        <h4>â˜€ï¸ Turning Toward Light (3 minutes)</h4>
                        <p>1. Stand with arms slightly outstretched</p>
                        <p>2. Close eyes and feel for what brings you joy</p>
                        <p>3. Imagine this as sunlight filtering through leaves</p>
                        <p>4. Slowly lean toward this feeling</p>
                        <p>5. Breathe it in: "I grow toward what nourishes me"</p>
                        <p><em>Even in shadow, remember light exists above.</em></p>
                    `
                },
                {
                    id: "network",
                    title: "Forest Network",
                    emoji: "ğŸŒ³",
                    description: "We're connected underground",
                    exercise: `
                        <h4>ğŸŒ³ Mycelium Connection (3 minutes)</h4>
                        <p>1. Sit comfortably with hands on lap, palms up</p>
                        <p>2. Visualize roots connecting you to all life</p>
                        <p>3. Feel support flowing through this network</p>
                        <p>4. Send love to someone who needs it</p>
                        <p>5. Receive support from the collective</p>
                        <p><em>You are never alone in the forest.</em></p>
                    `
                },
                {
                    id: "bend",
                    title: "Bend in Storms",
                    emoji: "ğŸŒ€",
                    description: "Flexibility prevents breaking",
                    exercise: `
                        <h4>ğŸŒ€ Storm Flexibility (3 minutes)</h4>
                        <p>1. Stand with knees slightly bent, arms relaxed</p>
                        <p>2. Recall a recent challenge or "storm"</p>
                        <p>3. Instead of resisting, imagine swaying with it</p>
                        <p>4. Feel your roots holding firm while you bend</p>
                        <p>5. Breathe: "I am strong because I am flexible"</p>
                        <p><em>Sometimes bending is the strongest response.</em></p>
                    `
                },
                {
                    id: "shape",
                    title: "Your True Shape",
                    emoji: "ğŸŒ²",
                    description: "A pine doesn't try to be an oak",
                    exercise: `
                        <h4>ğŸŒ² Authentic Being (3 minutes)</h4>
                        <p>1. Place a hand on your heart</p>
                        <p>2. Ask: "When do I feel most myself?"</p>
                        <p>3. Breathe into that feeling</p>
                        <p>4. Imagine your unique growth pattern</p>
                        <p>5. Affirm: "My true shape is beautiful as it is"</p>
                        <p><em>Your authentic being is your gift to the world.</em></p>
                    `
                }
            ],
            
            ge: [
                {
                    id: "root",
                    title: "áƒ¯áƒ”áƒ  áƒ¤áƒ”áƒ¡áƒ•áƒ”áƒ‘áƒ˜",
                    emoji: "ğŸŒ±",
                    description: "áƒ’áƒáƒ›áƒ§áƒáƒ áƒ“áƒ˜, áƒ¡áƒáƒœáƒáƒ› áƒ£áƒáƒáƒ¡áƒ£áƒ®áƒ”áƒ‘áƒ“áƒ”",
                    exercise: `
                        <h4>ğŸŒ± áƒ“áƒáƒ¤áƒ”áƒ¡áƒ•áƒ˜áƒáƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ¡áƒáƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ (3 áƒ¬áƒ£áƒ—áƒ˜)</h4>
                        <p>1. áƒ“áƒáƒ“áƒ”áƒ¥áƒ˜áƒ— áƒáƒœ áƒ“áƒáƒ¯áƒ”áƒ¥áƒ˜áƒ—, áƒ¤áƒ”áƒ®áƒ”áƒ‘áƒ˜áƒ— áƒ›áƒ˜áƒ¬áƒáƒ–áƒ”, áƒ˜áƒáƒ¢áƒáƒ™áƒ–áƒ”</p>
                        <p>2. áƒ“áƒáƒ®áƒ£áƒ­áƒ”áƒ— áƒ—áƒ•áƒáƒšáƒ”áƒ‘áƒ˜ áƒ“áƒ áƒ®áƒ”áƒšáƒ”áƒ‘áƒ˜ áƒ›áƒ£áƒªáƒ”áƒšáƒ–áƒ” áƒ“áƒáƒ˜áƒ“áƒ”áƒ—</p>
                        <p>3. áƒ©áƒáƒ˜áƒ¡áƒ£áƒœáƒ—áƒ¥áƒ”áƒ— 4 áƒ—áƒ•áƒšáƒáƒ–áƒ”: áƒ¬áƒáƒ áƒ›áƒáƒ˜áƒ“áƒ’áƒ˜áƒœáƒ”áƒ—, áƒ áƒáƒ› áƒ¤áƒ”áƒ®áƒ”áƒ‘áƒ˜áƒ“áƒáƒœ áƒ¤áƒ”áƒ¡áƒ•áƒ”áƒ‘áƒ˜ áƒ˜áƒ–áƒ áƒ“áƒ”áƒ‘áƒ áƒ“áƒ áƒ¦áƒ áƒ›áƒáƒ“ áƒ›áƒ˜áƒ“áƒ˜áƒ¡ áƒ›áƒ˜áƒ¬áƒáƒ¨áƒ˜</p>
                        <p>4. áƒáƒ›áƒáƒ˜áƒ¡áƒ£áƒœáƒ—áƒ¥áƒ”áƒ— 6 áƒ—áƒ•áƒšáƒáƒ–áƒ”: áƒ’áƒáƒ£áƒ¨áƒ•áƒ˜áƒ— áƒ“áƒáƒ«áƒáƒ‘áƒ£áƒšáƒáƒ‘áƒ áƒ›áƒ˜áƒ¬áƒáƒ¨áƒ˜, áƒ’áƒáƒ“áƒáƒ˜áƒ¢áƒáƒœáƒ”áƒ— áƒ˜áƒáƒ¢áƒáƒ™áƒ–áƒ”</p>
                        <p>5. áƒ’áƒáƒ˜áƒ›áƒ”áƒáƒ áƒ”áƒ—: "áƒ“áƒáƒ¤áƒ”áƒ¡áƒ•áƒ˜áƒáƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ•áƒáƒ . áƒáƒ¥ áƒ•áƒáƒ ."</p>
                        <p><em>áƒ¨áƒ”áƒ˜áƒ’áƒ áƒ«áƒ”áƒœáƒ˜áƒ— áƒ™áƒáƒ•áƒ¨áƒ˜áƒ áƒ˜ áƒ›áƒ˜áƒ¬áƒáƒ¡áƒ—áƒáƒœ, áƒ áƒáƒ›áƒ”áƒšáƒ˜áƒª áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ›áƒ®áƒáƒ áƒ“áƒáƒ›áƒ­áƒ”áƒ áƒ˜áƒ.</em></p>
                    `
                },
                {
                    id: "bark",
                    title: "áƒ®áƒ˜áƒ¡ áƒ¥áƒ”áƒ áƒ¥áƒ˜áƒ¡ áƒ¡áƒáƒ–áƒ¦áƒ•áƒ áƒ”áƒ‘áƒ˜",
                    emoji: "ğŸ›¡ï¸",
                    description: "áƒ“áƒáƒ˜áƒªáƒáƒ•áƒ˜, áƒ—áƒáƒœ áƒ’áƒáƒ®áƒ¡áƒœáƒ˜áƒšáƒ˜ áƒ“áƒáƒ áƒ©áƒ˜",
                    exercise: `
                        <h4>ğŸ›¡ï¸ áƒ¡áƒáƒ–áƒ¦áƒ•áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ¬áƒáƒ áƒ›áƒáƒ“áƒ’áƒ”áƒœáƒ (3 áƒ¬áƒ£áƒ—áƒ˜)</h4>
                        <p>1. áƒ“áƒáƒ®áƒ£áƒ­áƒ”áƒ— áƒ—áƒ•áƒáƒšáƒ”áƒ‘áƒ˜ áƒ“áƒ áƒ¬áƒáƒ áƒ›áƒáƒ˜áƒ“áƒ’áƒ˜áƒœáƒ”áƒ— áƒ“áƒáƒ›áƒªáƒáƒ•áƒ˜ áƒ”áƒœáƒ”áƒ áƒ’áƒ˜áƒ˜áƒ¡ áƒ•áƒ”áƒšáƒ˜</p>
                        <p>2. áƒ¬áƒáƒ áƒ›áƒáƒ˜áƒ“áƒ’áƒ˜áƒœáƒ”áƒ— áƒ˜áƒ¡, áƒ áƒáƒ’áƒáƒ áƒª áƒ®áƒ˜áƒ¡ áƒ¥áƒ”áƒ áƒ¥áƒ˜: áƒ«áƒšáƒ˜áƒ”áƒ áƒ˜ áƒ›áƒáƒ’áƒ áƒáƒ› áƒ’áƒáƒ›áƒ¢áƒáƒ áƒ˜</p>
                        <p>3. áƒ’áƒáƒœáƒ˜áƒ–áƒ áƒáƒ®áƒ”áƒ—, áƒ“áƒáƒ˜áƒ¡áƒáƒ®áƒ”áƒ—: "áƒ¨áƒ”áƒ›áƒáƒ•áƒ£áƒ¨áƒ•áƒ”áƒ‘ áƒ˜áƒ›áƒáƒ¡, áƒ áƒáƒª áƒ›áƒáƒ¡áƒáƒ–áƒ áƒ“áƒáƒ”áƒ‘áƒ¡"</p>
                        <p>4. "áƒ’áƒáƒ•áƒªáƒ®áƒ áƒ˜áƒšáƒáƒ• áƒ˜áƒ›áƒáƒ¡, áƒ áƒáƒª áƒ›áƒ¨áƒšáƒ˜áƒ¡, áƒ áƒáƒª áƒ”áƒœáƒ”áƒ áƒ’áƒ˜áƒáƒ¡ áƒ›áƒáƒªáƒšáƒ˜áƒ¡"</p>
                        <p>5. áƒ˜áƒ’áƒ áƒ«áƒ”áƒœáƒ˜áƒ— áƒ”áƒ¡ áƒ¡áƒáƒ–áƒ¦áƒ•áƒáƒ áƒ˜, áƒ›áƒáƒ¥áƒœáƒ˜áƒšáƒ˜, áƒ—áƒ£áƒ›áƒªáƒ áƒ›áƒ¢áƒ™áƒ˜áƒªáƒ”</p>
                        <p><em>áƒ¯áƒáƒœáƒ¡áƒáƒ¦áƒ˜ áƒ¡áƒáƒ–áƒ¦áƒ•áƒ áƒ”áƒ‘áƒ˜ áƒ¡áƒ˜áƒ§áƒ•áƒáƒ áƒ£áƒšáƒ˜áƒ, áƒáƒ áƒ áƒ™áƒ”áƒ“áƒ”áƒšáƒ˜.</em></p>
                    `
                },
                {
                    id: "rings",
                    title: "áƒ áƒ’áƒáƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ–áƒ áƒ“áƒ",
                    emoji: "ğŸ‹",
                    description: "áƒ§áƒáƒ•áƒ”áƒšáƒ˜ áƒ’áƒáƒ›áƒáƒªáƒ“áƒ˜áƒšáƒ”áƒ‘áƒ áƒ«áƒáƒšáƒáƒ¡ áƒ”áƒ›áƒáƒ¢áƒ”áƒ‘áƒ",
                    exercise: `
                        <h4>ğŸ‹ áƒ–áƒ áƒ“áƒ˜áƒ¡ áƒ áƒ’áƒáƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ”áƒ“áƒ˜áƒ¢áƒáƒªáƒ˜áƒ (3 áƒ¬áƒ£áƒ—áƒ˜)</h4>
                        <p>1. áƒ“áƒáƒ˜áƒ“áƒ”áƒ— áƒ®áƒ”áƒšáƒ˜ áƒ’áƒ£áƒšáƒ–áƒ”</p>
                        <p>2. áƒ’áƒáƒ˜áƒ®áƒ¡áƒ”áƒœáƒ”áƒ— áƒ‘áƒáƒšáƒáƒ“áƒ áƒáƒ˜áƒœáƒ“áƒ”áƒšáƒ˜ áƒ’áƒáƒ›áƒáƒªáƒ“áƒ˜áƒšáƒ”áƒ‘áƒ, áƒ áƒ—áƒ£áƒšáƒ˜ áƒ—áƒ£ áƒ¡áƒáƒ¡áƒ˜áƒ®áƒáƒ áƒ£áƒšáƒ</p>
                        <p>3. áƒ©áƒáƒ˜áƒ¡áƒ£áƒœáƒ—áƒ¥áƒ”áƒ—: "áƒ”áƒ¡ áƒ©áƒ”áƒ›áƒ˜ áƒ«áƒáƒšáƒ˜áƒ¡ áƒœáƒáƒ¬áƒ˜áƒšáƒ˜ áƒ®áƒ“áƒ”áƒ‘áƒ"</p>
                        <p>4. áƒ¬áƒáƒ áƒ›áƒáƒ˜áƒ“áƒ’áƒ˜áƒœáƒ”áƒ—, áƒ áƒáƒ› áƒ˜áƒ¡ áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒáƒ áƒ¡áƒ”áƒ‘áƒ˜áƒ¡ áƒ’áƒ£áƒšáƒ¨áƒ˜ áƒáƒ®áƒáƒš áƒ áƒ’áƒáƒšáƒ¡ áƒ¥áƒ›áƒœáƒ˜áƒ¡</p>
                        <p>5. áƒ›áƒáƒ“áƒšáƒáƒ‘áƒ áƒ’áƒáƒ“áƒáƒ£áƒ®áƒáƒ“áƒ”áƒ—, áƒ áƒáƒ› áƒ’áƒáƒ’áƒªáƒ˜áƒáƒ— áƒ˜áƒ¡, áƒ•áƒ˜áƒœáƒª áƒ®áƒáƒ áƒ—.</p>
                        <p><em>áƒ§áƒáƒ•áƒ”áƒšáƒ˜ áƒ áƒ’áƒáƒšáƒ˜, áƒ¡áƒ¥áƒ”áƒšáƒ˜ áƒ—áƒ£ áƒ—áƒ®áƒ”áƒšáƒ˜, áƒ—áƒ¥áƒ•áƒ”áƒœáƒ¡ áƒ›áƒ—áƒšáƒ˜áƒáƒœáƒáƒ‘áƒáƒ¡ áƒ£áƒ¬áƒ§áƒáƒ‘áƒ¡ áƒ®áƒ”áƒšáƒ¡.</em></p>
                    `
                },
                {
                    id: "release",
                    title: "áƒ¡áƒ”áƒ–áƒáƒœáƒ£áƒ áƒ˜ áƒ’áƒáƒ—áƒáƒ•áƒ˜áƒ¡áƒ£áƒ¤áƒšáƒ”áƒ‘áƒ",
                    emoji: "ğŸ‚",
                    description: "áƒ’áƒáƒ£áƒ¨áƒ•áƒ˜, áƒ áƒáƒª áƒáƒ¦áƒáƒ  áƒ’áƒ”áƒ›áƒ¡áƒáƒ®áƒ£áƒ áƒ”áƒ‘áƒ",
                    exercise: `
                        <h4>ğŸ‚ áƒ’áƒáƒ¨áƒ•áƒ”áƒ‘áƒ˜áƒ¡ áƒ áƒ˜áƒ¢áƒ£áƒáƒšáƒ˜ (3 áƒ¬áƒ£áƒ—áƒ˜)</h4>
                        <p>1. áƒ’áƒáƒ˜áƒ®áƒ¡áƒ”áƒœáƒ”áƒ— áƒ˜áƒ¡áƒ”áƒ—áƒ˜ áƒ áƒáƒ›, áƒ áƒ˜áƒ¡áƒ˜ áƒ’áƒáƒ¨áƒ•áƒ”áƒ‘áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡áƒáƒª áƒ›áƒ–áƒáƒ“ áƒ®áƒáƒ áƒ—</p>
                        <p>2. áƒáƒ–áƒ áƒ˜áƒ— áƒ“áƒáƒ¬áƒ”áƒ áƒ”áƒ— áƒ˜áƒ¡ áƒ¨áƒ”áƒ›áƒáƒ“áƒ’áƒáƒ›áƒ˜áƒ¡ áƒ¤áƒáƒ—áƒáƒšáƒ–áƒ”</p>
                        <p>3. áƒ¦áƒ áƒ›áƒáƒ“ áƒ˜áƒ¡áƒ£áƒœáƒ—áƒ¥áƒ”áƒ— áƒ“áƒ áƒ¬áƒáƒ áƒ›áƒáƒ˜áƒ“áƒ’áƒ˜áƒœáƒ”áƒ—, áƒ áƒáƒ’áƒáƒ  áƒªáƒ•áƒ˜áƒ•áƒ áƒ¤áƒáƒ—áƒáƒšáƒ˜</p>
                        <p>4. áƒ£áƒ§áƒ£áƒ áƒ”áƒ—, áƒ áƒáƒ’áƒáƒ  áƒœáƒáƒ–áƒáƒ“ áƒ”áƒ¨áƒ•áƒ”áƒ‘áƒ áƒ›áƒ˜áƒ¬áƒáƒ–áƒ”</p>
                        <p>5. áƒ—áƒ¥áƒ•áƒ˜áƒ—: "áƒ¡áƒ˜áƒ§áƒ•áƒáƒ áƒ£áƒšáƒ˜áƒ— áƒ’áƒáƒ—áƒáƒ•áƒ˜áƒ¡áƒ£áƒ¤áƒšáƒ”áƒ‘. áƒáƒ®áƒáƒšáƒ˜ áƒ–áƒ áƒ“áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡ áƒáƒ“áƒ’áƒ˜áƒšáƒ¡ áƒ•áƒáƒ—áƒáƒ•áƒ˜áƒ¡áƒ£áƒ¤áƒšáƒ”áƒ‘."</p>
                        <p><em>áƒ’áƒáƒ¨áƒ•áƒ”áƒ‘áƒ áƒªáƒ˜áƒ™áƒšáƒ¨áƒ˜ áƒœáƒ“áƒáƒ‘áƒ˜áƒ¡ áƒœáƒ˜áƒ¨áƒáƒœáƒ˜áƒ.</em></p>
                    `
                },
                {
                    id: "light",
                    title: "áƒ¡áƒ˜áƒœáƒáƒ—áƒšáƒ˜áƒ¡áƒ™áƒ”áƒœ áƒ¬áƒ•áƒ“áƒáƒ›áƒ",
                    emoji: "â˜€ï¸",
                    description: "áƒ˜áƒ¥áƒ˜áƒ— áƒ’áƒáƒ˜áƒ–áƒ áƒ“áƒ”áƒ‘áƒ˜, áƒ¡áƒáƒ˜áƒ“áƒáƒœáƒáƒª áƒ˜áƒ™áƒ•áƒ”áƒ‘áƒ”áƒ‘áƒ˜",
                    exercise: `
                        <h4>â˜€ï¸ áƒ¡áƒ˜áƒœáƒáƒ—áƒšáƒ˜áƒ¡áƒ™áƒ”áƒœ áƒ›áƒ˜áƒ‘áƒ áƒ£áƒœáƒ”áƒ‘áƒ (3 áƒ¬áƒ£áƒ—áƒ˜)</h4>
                        <p>1. áƒ“áƒáƒ“áƒ”áƒ¥áƒ˜áƒ— áƒáƒ“áƒœáƒáƒ• áƒ’áƒáƒ¨áƒšáƒ˜áƒšáƒ˜ áƒ®áƒ”áƒšáƒ”áƒ‘áƒ˜áƒ— (áƒ®áƒ˜áƒ¡ áƒ¢áƒáƒ¢áƒ˜áƒ•áƒ˜áƒ— áƒ’áƒáƒ˜áƒ¬áƒáƒ“áƒ”áƒ— áƒ®áƒ”áƒšáƒ˜)</p>
                        <p>2. áƒ“áƒáƒ®áƒ£áƒ­áƒ”áƒ— áƒ—áƒ•áƒáƒšáƒ”áƒ‘áƒ˜ áƒ“áƒ áƒ˜áƒ’áƒ áƒ«áƒ”áƒœáƒ˜áƒ—, áƒ—áƒ£ áƒ áƒ áƒ’áƒáƒœáƒ˜áƒ­áƒ”áƒ‘áƒ— áƒ¡áƒ˜áƒ®áƒáƒ áƒ£áƒšáƒ¡</p>
                        <p>3. áƒ¬áƒáƒ áƒ›áƒáƒ˜áƒ“áƒ’áƒ˜áƒœáƒ”áƒ—, áƒ áƒáƒ› áƒ›áƒ–áƒ˜áƒ¡ áƒ¡áƒ®áƒ˜áƒ•áƒ”áƒ‘áƒ˜ áƒ¤áƒáƒ—áƒšáƒ”áƒ‘áƒ¨áƒ˜ áƒáƒ¦áƒ¬áƒ”áƒ•áƒ¡</p>
                        <p>4. áƒœáƒ”áƒšáƒ áƒ“áƒáƒ˜áƒ®áƒáƒ áƒ”áƒ— áƒáƒ› áƒ’áƒ áƒ«áƒœáƒáƒ‘áƒ˜áƒ¡áƒ™áƒ”áƒœ</p>
                        <p>5. áƒ©áƒáƒ˜áƒ¡áƒ£áƒœáƒ—áƒ¥áƒ”áƒ—: "áƒ•áƒ˜áƒ–áƒ áƒ“áƒ”áƒ‘áƒ˜ áƒ˜áƒ›áƒ˜áƒ¡áƒ™áƒ”áƒœ, áƒ áƒáƒª áƒ›áƒ™áƒ•áƒ”áƒ‘áƒáƒ•áƒ¡"</p>
                        <p><em>áƒ©áƒ áƒ“áƒ˜áƒšáƒ¨áƒ˜áƒª áƒ™áƒ˜ áƒ’áƒáƒ®áƒ¡áƒáƒ•áƒ“áƒ”áƒ—, áƒ áƒáƒ› áƒ–áƒ”áƒ›áƒáƒ— áƒ¡áƒ˜áƒœáƒáƒ—áƒšáƒ” áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡.</em></p>
                    `
                },
                {
                    id: "network",
                    title: "áƒ¢áƒ§áƒ˜áƒ¡ áƒ¥áƒ¡áƒ”áƒšáƒ˜",
                    emoji: "ğŸŒ³",
                    description: "áƒ©áƒ•áƒ”áƒœ áƒ›áƒ˜áƒ¬áƒ˜áƒ¡áƒ¥áƒ•áƒ”áƒ¨ áƒ•áƒáƒ áƒ— áƒ“áƒáƒ™áƒáƒ•áƒ¨áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜",
                    exercise: `
                        <h4>ğŸŒ³ áƒ›áƒ˜áƒªáƒ”áƒšáƒ˜áƒ£áƒ›áƒ˜áƒ¡ áƒ™áƒáƒ•áƒ¨áƒ˜áƒ áƒ˜ (3 áƒ¬áƒ£áƒ—áƒ˜)</h4>
                        <p>1. áƒ“áƒáƒ¯áƒ”áƒ¥áƒ˜áƒ— áƒ™áƒáƒ›áƒ¤áƒáƒ áƒ¢áƒ£áƒšáƒáƒ“, áƒ®áƒ”áƒšáƒ”áƒ‘áƒ˜ áƒ™áƒáƒšáƒ—áƒáƒ¨áƒ˜ áƒ©áƒáƒ˜áƒ¬áƒ§áƒ”áƒ—, áƒ®áƒ”áƒšáƒ˜áƒ¡áƒ’áƒ£áƒšáƒ”áƒ‘áƒ˜áƒ— áƒ–áƒ”áƒ›áƒáƒ—</p>
                        <p>2. áƒ¬áƒáƒ áƒ›áƒáƒ˜áƒ“áƒ’áƒ˜áƒœáƒ”áƒ— áƒ¤áƒ”áƒ¡áƒ•áƒ”áƒ‘áƒ˜, áƒ áƒáƒ›áƒšáƒ”áƒ‘áƒ˜áƒª áƒ§áƒ•áƒ”áƒšáƒ áƒ¡áƒ®áƒ•áƒ áƒ¡áƒ˜áƒªáƒáƒªáƒ®áƒšáƒ”áƒ¡áƒ—áƒáƒœ áƒ’áƒáƒ™áƒáƒ•áƒ¨áƒ˜áƒ áƒ”áƒ‘áƒ—</p>
                        <p>3. áƒ˜áƒ’áƒ áƒ«áƒ”áƒœáƒ˜áƒ— áƒ›áƒ®áƒáƒ áƒ“áƒáƒ­áƒ”áƒ áƒ, áƒ áƒáƒ›áƒ”áƒšáƒ˜áƒª áƒáƒ› áƒ¥áƒ¡áƒ”áƒšáƒ˜áƒ“áƒáƒœ áƒ›áƒáƒ”áƒ“áƒ˜áƒœáƒ”áƒ‘áƒ</p>
                        <p>4. áƒ’áƒáƒ£áƒ’áƒ–áƒáƒ•áƒœáƒ”áƒ— áƒ¡áƒ˜áƒ§áƒ•áƒáƒ áƒ£áƒšáƒ˜ áƒ›áƒáƒ¡, áƒ•áƒ˜áƒ¡áƒáƒª áƒ”áƒ¡ áƒ¡áƒ­áƒ˜áƒ áƒ“áƒ”áƒ‘áƒ</p>
                        <p>5. áƒ›áƒ˜áƒ˜áƒ¦áƒ”áƒ— áƒ›áƒ®áƒáƒ áƒ“áƒáƒ­áƒ”áƒ áƒ áƒ™áƒáƒšáƒ”áƒ¥áƒ¢áƒ˜áƒ•áƒ˜áƒ¡áƒ’áƒáƒœ</p>
                        <p><em>áƒ¢áƒ§áƒ”áƒ¨áƒ˜ áƒáƒ áƒáƒ¡áƒ“áƒ áƒáƒ¡ áƒ®áƒáƒ  áƒ›áƒáƒ áƒ¢áƒ.</em></p>
                    `
                },
                {
                    id: "bend",
                    title: "áƒ áƒ®áƒ”áƒ•áƒ áƒ¥áƒáƒ áƒ˜áƒ¨áƒ®áƒáƒšáƒ¨áƒ˜",
                    emoji: "ğŸŒ€",
                    description: "áƒ›áƒáƒ¥áƒœáƒ˜áƒšáƒáƒ‘áƒ áƒ’áƒáƒ¢áƒ”áƒ®áƒ•áƒáƒ¡ áƒ’áƒáƒ“áƒáƒ’áƒáƒ áƒ©áƒ”áƒœáƒ¡",
                    exercise: `
                        <h4>ğŸŒ€ áƒ›áƒáƒ¥áƒœáƒ˜áƒšáƒáƒ‘áƒ áƒ¥áƒáƒ áƒ˜áƒ¨áƒ®áƒáƒšáƒ¨áƒ˜ (3 áƒ¬áƒ£áƒ—áƒ˜)</h4>
                        <p>1. áƒ“áƒáƒ“áƒ”áƒ¥áƒ˜áƒ— áƒáƒ“áƒœáƒáƒ• áƒ›áƒáƒ®áƒ áƒ˜áƒšáƒ˜ áƒ›áƒ£áƒ®áƒšáƒ”áƒ‘áƒ˜áƒ—, áƒ›áƒáƒ“áƒ£áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ®áƒ”áƒšáƒ”áƒ‘áƒ˜áƒ—</p>
                        <p>2. áƒ’áƒáƒ˜áƒ®áƒ¡áƒ”áƒœáƒ”áƒ— áƒ‘áƒáƒšáƒáƒ“áƒ áƒáƒ˜áƒœáƒ“áƒ”áƒšáƒ˜ áƒ’áƒáƒ›áƒáƒ¬áƒ•áƒ”áƒ•áƒ áƒáƒœ "áƒ¥áƒáƒ áƒ˜áƒ¨áƒ®áƒáƒšáƒ˜"</p>
                        <p>3. áƒ¬áƒ˜áƒœáƒáƒáƒ¦áƒ›áƒ“áƒ”áƒ’áƒáƒ‘áƒ˜áƒ¡ áƒœáƒáƒªáƒ•áƒšáƒáƒ“, áƒ¬áƒáƒ áƒ›áƒáƒ˜áƒ“áƒ’áƒ˜áƒœáƒ”áƒ—, áƒ áƒáƒ› áƒ›áƒáƒ¡áƒ—áƒáƒœ áƒ”áƒ áƒ—áƒáƒ“ áƒ˜áƒ áƒ®áƒ”áƒ•áƒ˜áƒ—</p>
                        <p>4. áƒ˜áƒ’áƒ áƒ«áƒ”áƒœáƒ˜áƒ—, áƒ áƒáƒ’áƒáƒ  áƒ›áƒ¢áƒ™áƒ˜áƒªáƒ”áƒ“ áƒ’áƒ˜áƒ­áƒ”áƒ áƒ— áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ¤áƒ”áƒ¡áƒ•áƒ”áƒ‘áƒ˜ áƒ›áƒáƒ®áƒ áƒ˜áƒ¡áƒáƒ¡</p>
                        <p>5. áƒ˜áƒ¡áƒ£áƒœáƒ—áƒ¥áƒ”áƒ—: "áƒ«áƒšáƒ˜áƒ”áƒ áƒ˜ áƒ•áƒáƒ , áƒ áƒáƒ“áƒ’áƒáƒœ áƒ›áƒáƒ¥áƒœáƒ˜áƒšáƒ˜ áƒ•áƒáƒ "</p>
                        <p><em>áƒ–áƒáƒ’áƒ¯áƒ”áƒ  áƒ›áƒáƒ®áƒ áƒ áƒ§áƒ•áƒ”áƒšáƒáƒ–áƒ” áƒ«áƒšáƒ˜áƒ”áƒ áƒ˜ áƒáƒáƒ¡áƒ£áƒ®áƒ˜áƒ.</em></p>
                    `
                },
                {
                    id: "shape",
                    title: "áƒ¨áƒ”áƒœáƒ˜ áƒœáƒáƒ›áƒ“áƒ•áƒ˜áƒšáƒ˜ áƒ¤áƒáƒ áƒ›áƒ",
                    emoji: "ğŸŒ²",
                    description: "áƒœáƒáƒ«áƒ•áƒ˜ áƒáƒ  áƒªáƒ“áƒ˜áƒšáƒáƒ‘áƒ¡ áƒ›áƒ£áƒ®áƒ áƒ˜áƒ§áƒáƒ¡",
                    exercise: `
                        <h4>ğŸŒ² áƒ’áƒ£áƒšáƒ¬áƒ áƒ¤áƒ”áƒšáƒáƒ‘áƒ (3 áƒ¬áƒ£áƒ—áƒ˜)</h4>
                        <p>1. áƒ“áƒáƒ˜áƒ“áƒ”áƒ— áƒ®áƒ”áƒšáƒ˜ áƒ’áƒ£áƒšáƒ–áƒ”</p>
                        <p>2. áƒ°áƒ™áƒ˜áƒ—áƒ®áƒ”áƒ—: "áƒ áƒáƒ“áƒ˜áƒ¡ áƒ•áƒ’áƒ áƒ«áƒœáƒáƒ‘ áƒ§áƒ•áƒ”áƒšáƒáƒ–áƒ” áƒ›áƒ”áƒ¢áƒáƒ“ áƒ¡áƒáƒ™áƒ£áƒ—áƒáƒ  áƒ—áƒáƒ•áƒ¡? (áƒ£áƒ¤áƒ áƒ áƒ áƒáƒ“áƒ˜áƒ¡ áƒ¨áƒ”áƒ•áƒ˜áƒ’áƒ áƒ«áƒœáƒáƒ‘ áƒ©áƒ”áƒ›áƒ¡ áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ¡?)"</p>
                        <p>3. áƒ©áƒáƒ˜áƒ¡áƒ£áƒœáƒ—áƒ¥áƒ”áƒ— áƒáƒ› áƒ’áƒ áƒ«áƒœáƒáƒ‘áƒ˜áƒ—</p>
                        <p>4. áƒ¬áƒáƒ áƒ›áƒáƒ˜áƒ“áƒ’áƒ˜áƒœáƒ”áƒ— áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ£áƒœáƒ˜áƒ™áƒáƒšáƒ£áƒ áƒ˜ áƒ–áƒ áƒ“áƒ˜áƒ¡ áƒœáƒ˜áƒ›áƒ£áƒ¨áƒ˜</p>
                        <p>5. áƒ“áƒáƒáƒ“áƒáƒ¡áƒ¢áƒ£áƒ áƒ”áƒ—: "áƒ©áƒ”áƒ›áƒ˜ áƒœáƒáƒ›áƒ“áƒ•áƒ˜áƒšáƒ˜ áƒ¤áƒáƒ áƒ›áƒ áƒšáƒáƒ›áƒáƒ–áƒ˜áƒ, áƒ áƒáƒ’áƒáƒ áƒ˜áƒª áƒáƒ áƒ˜áƒ¡."</p>
                        <p><em>áƒ¨áƒ”áƒœáƒ˜ áƒ’áƒ£áƒšáƒ¬áƒ áƒ¤áƒ”áƒšáƒáƒ‘áƒ áƒ¨áƒ”áƒœáƒ˜ áƒ¡áƒáƒ©áƒ£áƒ¥áƒáƒ áƒ˜áƒ áƒ¡áƒáƒ›áƒ§áƒáƒ áƒáƒ¡áƒ—áƒ•áƒ˜áƒ¡.</em></p>
                    `
                }
            ]
        };
        
        // ==================== KEYWORDS FOR CONTEXTUAL MATCHING ====================
        
        const categoryKeywords = {
            en: {
                rooting: ['ground', 'grounded', 'stable', 'stability', 'foundation', 'root', 'rooted', 'shake', 'shakes', 'shaking', 'tremble', 'trembling', 'unsure', 'uncertain', 'lost', 'anchor', 'steady', 'earth', 'soil', 'foundation', 'base', 'based', 'security', 'secure', 'solid', 'firmly'],
                bark: ['boundary', 'protect', 'protected', 'shield', 'defend', 'defense', 'wall', 'walls', 'barrier', 'safe', 'safety', 'safely', 'vulnerable', 'guard', 'guarded', 'limit', 'limits', 'borders', 'private', 'privacy', 'limitation', 'protect', 'shell', 'armor', 'shield', 'protection'],
                rings: ['grow', 'grown', 'grew', 'growing', 'learn', 'learning', 'learned', 'experience', 'experienced', 'year', 'years', 'time', 'past', 'memory', 'memories', 'history', 'story', 'lesson', 'age', 'aged', 'circle', 'ring', 'rings', 'growth', 'matured', 'maturity', 'mature'],
                release: ['let go', 'letting go', 'release', 'released', 'releasing', 'forgive', 'forgave', 'forgiven', 'move on', 'moving on', 'past', 'old', 'change', 'changes', 'changing', 'changed', 'end', 'goodbye', 'leave', 'leaves', 'falls', 'shed', 'autumn', 'freed', 'cleared', 'liberating', 'detach'],
                reaching: ['goal', 'aspire', 'aspiring', 'light', 'reach', 'reached', 'aim', 'aiming', 'purpose', 'dream', 'dreams', 'future', 'hope', 'hopes', 'hoping', 'want', 'wants', 'aspiration', 'target', 'ambition', 'ambitions', 'ambitious', 'desires', 'goal', 'strive', 'strives', 'climb', 'aspire'],
                network: ['connect', 'connects', 'connecting', 'friend', 'friends', 'friendly', 'family', 'community', 'together', 'alone', 'lonely', 'isolated', 'support', 'supports', 'supporting', 'supported', 'help', 'helps', 'helpful', 'share', 'shared', 'shares', 'together', 'community', 'connection', 'support', 'togetherness'],
                bending: ['flexible', 'flexibility', 'bend', 'bending', 'bent', 'storm', 'challenge', 'difficult', 'hard', 'resilient', 'adapt', 'adapts', 'adapting', 'adaptation', 'change', 'changing', 'yield', 'yields', 'yielding', 'flex', 'wind', 'windy', 'weather', 'adapt', 'resilient', 'resilience'],
                shape: ['authentic', 'true', 'truth', 'truthful', 'self', 'identity', 'who am i', 'who i am', 'unique', 'different', 'real', 'genuine', 'genuinely', 'original', 'originality', 'me', 'myself', 'authenticity', 'individual', 'individuality', 'true self', 'identity'],
                seasons: ['cycle', 'cycles', 'cyclic', 'season', 'seasons', 'seasonal', 'change', 'changes', 'phase', 'phases', 'period', 'periodic', 'time', 'rhythm', 'rhythms', 'pattern', 'patterns', 'repeat', 'repeats', 'repeating', 'return', 'spring', 'summer', 'winter', 'autumn', 'transformation', 'cycle'],
                wholeness: ['heal', 'healed', 'whole', 'wholeness', 'complete', 'integrate', 'integrates', 'integrating', 'integrated', 'integration', 'scar', 'scars', 'scarred', 'broken',  'repair', 'repairs', 'repaired', 'mend', 'mends', 'mending', 'fix', 'recover', 'recovery', 'recovering', 'healing', 'integration', 'scars', 'heal', 'whole'],
                patience: ['wait', 'waits', 'waiting', 'patience', 'patiently', 'slow', 'slower', 'slowly', 'time', 'process', 'processing', 'gradual', 'gradually', 'evolve', 'evolves', 'evolving', 'develop', 'developing', 'grow', 'unfold', 'unfolding', 'unfolded', 'patience', 'waiting', 'gradual', 'patient', 'wait'],
                presence: ['now', 'present', 'mindful', 'aware', 'awareness', 'moment', 'here', 'today', 'attention', 'focus', 'focuses', 'focusing', 'focused', 'current', 'now', 'present', 'mindfulness', 'aware', 'conscious', 'breath', 'breathing', 'now']
            },
    
    ge: {
        rooting: ['áƒ¤áƒ”áƒ¡áƒ•áƒ˜', 'áƒ¤áƒ”áƒ¡áƒ•', 'áƒ›áƒ˜áƒ¬áƒ', 'áƒ›áƒ˜áƒ¬', 'áƒ¡áƒáƒ¤áƒ£áƒ«áƒ•áƒ”áƒšáƒ˜', 'áƒ¤áƒ£áƒ«', 'áƒ“áƒáƒ›áƒáƒ’áƒ áƒ”áƒ‘áƒ', 'áƒ›áƒáƒ’áƒ ', 'áƒ›áƒ§áƒáƒ ', 'áƒ¡áƒ¢áƒáƒ‘áƒ˜áƒšáƒ£áƒ áƒáƒ‘áƒ', 'áƒ“áƒáƒ«áƒ áƒ£áƒšáƒ˜', 'áƒ“áƒáƒ™áƒáƒ áƒ’áƒ£áƒšáƒ˜', 'áƒ¦áƒ£áƒœáƒ', 'áƒ¬áƒáƒœáƒáƒ¡áƒ¬áƒáƒ áƒáƒ‘áƒ', 'áƒ“áƒ”áƒ“áƒáƒ›áƒ˜áƒ¬áƒ', 'áƒœáƒ˜áƒáƒ“áƒáƒ’áƒ˜', 'áƒ‘áƒáƒ–áƒ', 'áƒ¡áƒáƒ¤áƒ áƒ—áƒ®', 'áƒ£áƒ¡áƒáƒ¤áƒ áƒ—áƒ®áƒ'],
        bark: ['áƒ¡áƒáƒ–áƒ¦áƒ•áƒáƒ áƒ˜', 'áƒ–áƒ¦áƒ•áƒáƒ ', 'áƒ“áƒáƒªáƒ•áƒ', 'áƒ¤áƒáƒ áƒ˜', 'áƒ—áƒáƒ•áƒ“áƒáƒªáƒ•áƒ', 'áƒ™áƒ”áƒ“áƒ”áƒšáƒ˜', 'áƒ‘áƒáƒ áƒ˜áƒ”áƒ áƒ˜', 'áƒ£áƒ¡áƒáƒ¤áƒ áƒ—áƒ®áƒ', 'áƒ“áƒáƒ£áƒªáƒ•áƒ”áƒšáƒ˜', 'áƒ›áƒªáƒ•áƒ”áƒšáƒ˜', 'áƒšáƒ˜áƒ›áƒ˜áƒ¢áƒ˜', 'áƒ™áƒáƒœáƒ˜', 'áƒ¯áƒáƒ•áƒ¨áƒáƒœáƒ˜', 'áƒ“áƒáƒªáƒ£áƒš', 'áƒ“áƒáƒªáƒ£áƒšáƒ˜'],
        rings: ['áƒ–áƒ áƒ“áƒ', 'áƒ–áƒ áƒ“áƒ˜áƒ¡', 'áƒ¡áƒ¬áƒáƒ•áƒšáƒ', 'áƒ’áƒáƒ›áƒáƒªáƒ“áƒ˜áƒšáƒ”áƒ‘áƒ', 'áƒ¬áƒ”áƒšáƒ˜', 'áƒ“áƒ áƒ', 'áƒ¬áƒáƒ áƒ¡áƒ£áƒšáƒ˜', 'áƒ›áƒ”áƒ®áƒ¡áƒ˜áƒ”áƒ áƒ”áƒ‘áƒ', 'áƒ˜áƒ¡áƒ¢áƒáƒ áƒ˜áƒ', 'áƒ’áƒáƒ™áƒ•áƒ”áƒ—áƒ˜áƒšáƒ˜', 'áƒáƒ¡áƒáƒ™áƒ˜', 'áƒ¬áƒ áƒ”', 'áƒ áƒ’áƒáƒšáƒ˜', 'áƒ›áƒáƒ–áƒ áƒ“áƒ˜áƒšáƒ˜', 'áƒ’áƒáƒ–áƒ áƒ“áƒ˜áƒšáƒ˜'],
        release: ['áƒ’áƒáƒ—áƒáƒ•áƒ˜áƒ¡áƒ£áƒ¤áƒšáƒ”áƒ‘áƒ', 'áƒáƒáƒ¢áƒ˜áƒ”áƒ‘áƒ', 'áƒ’áƒáƒ“áƒáƒáƒ“áƒ’áƒ˜áƒšáƒ”áƒ‘áƒ', 'áƒ¬áƒáƒ áƒ¡áƒ£áƒšáƒ˜', 'áƒ«áƒ•áƒ”áƒšáƒ˜', 'áƒªáƒ•áƒšáƒ˜áƒšáƒ”áƒ‘áƒ', 'áƒ“áƒáƒ¡áƒáƒ¡áƒ áƒ£áƒšáƒ˜', 'áƒœáƒáƒ®áƒ•áƒáƒ›áƒ“áƒ˜áƒ¡', 'áƒ“áƒáƒ¢áƒáƒ•áƒ”áƒ‘áƒ', 'áƒ©áƒáƒ›áƒáƒ’áƒ“áƒ”áƒ‘áƒ', 'áƒ¨áƒ”áƒ›áƒáƒ“áƒ’áƒáƒ›áƒ', 'áƒ’áƒáƒ¨áƒ•áƒ”áƒ‘áƒ', 'áƒ’áƒáƒ•áƒ£áƒ¨áƒ•áƒ˜', 'áƒ’áƒáƒœáƒ¨áƒáƒ áƒ”áƒ‘áƒ'],
        reaching: ['áƒ›áƒ˜áƒ–áƒáƒœáƒ˜', 'áƒ¨áƒ”áƒ¥áƒ›áƒœáƒ', 'áƒ¡áƒ˜áƒœáƒáƒ—áƒšáƒ”', 'áƒ¡áƒ˜áƒœáƒáƒ—áƒšáƒ˜áƒ¡', 'áƒ›áƒ˜áƒ¦áƒ¬áƒ”áƒ•áƒ', 'áƒ›áƒ˜áƒ–áƒáƒœáƒ˜', 'áƒáƒªáƒœáƒ”áƒ‘áƒ', 'áƒ›áƒáƒ›áƒáƒ•áƒáƒšáƒ˜', 'áƒ›áƒáƒ›áƒáƒ•áƒáƒšáƒ¡', 'áƒ˜áƒ›áƒ”áƒ“áƒ˜', 'áƒ¡áƒ£áƒ áƒ•áƒ˜áƒšáƒ˜', 'áƒ¡áƒáƒ›áƒ˜áƒ–áƒœáƒ”', 'áƒáƒ›áƒ‘áƒ˜áƒªáƒ˜áƒ', 'áƒ¨áƒ”áƒ¥áƒ›áƒœáƒ'],
        network: ['áƒ™áƒáƒ•áƒ¨áƒ˜áƒ áƒ˜', 'áƒ›áƒ”áƒ’áƒáƒ‘áƒáƒ áƒ˜', 'áƒáƒ¯áƒáƒ®áƒ˜', 'áƒ—áƒáƒœáƒáƒ›áƒ”áƒ’áƒáƒ‘áƒ áƒáƒ‘áƒ', 'áƒ”áƒ áƒ—áƒáƒ“', 'áƒ›áƒáƒ áƒ¢áƒ', 'áƒ˜áƒ–áƒáƒšáƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜', 'áƒ›áƒ®áƒáƒ áƒ“áƒáƒ­áƒ”áƒ áƒ', 'áƒ“áƒáƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒ', 'áƒ’áƒáƒ–áƒ˜áƒáƒ áƒ”áƒ‘áƒ', 'áƒ—áƒáƒœáƒáƒ›áƒ”áƒ’áƒáƒ‘áƒ áƒáƒ‘áƒ', 'áƒ™áƒáƒ•áƒ¨áƒ˜áƒ áƒ˜', 'áƒ›áƒ®áƒáƒ áƒ“áƒáƒ­áƒ”áƒ áƒ'],
        bending: ['áƒ›áƒáƒ¥áƒœáƒ˜áƒšáƒ˜', 'áƒ“áƒáƒ®áƒ áƒ', 'áƒ›áƒáƒ®áƒ áƒ', 'áƒ¥áƒáƒ áƒ˜áƒ¨áƒ®áƒáƒšáƒ˜', 'áƒ’áƒáƒ›áƒáƒ¬áƒ•áƒ”áƒ•áƒ', 'áƒ áƒ—áƒ£áƒšáƒ˜', 'áƒ’áƒáƒ›áƒ«áƒšáƒ”', 'áƒáƒ“áƒáƒáƒ¢áƒáƒªáƒ˜áƒ', 'áƒªáƒ•áƒšáƒ˜áƒšáƒ”áƒ‘áƒ', 'áƒ“áƒáƒœáƒ”áƒ‘áƒ”áƒ‘áƒ', 'áƒ›áƒáƒ¥áƒœáƒ˜áƒšáƒáƒ‘áƒ', 'áƒ¥áƒáƒ áƒ˜', 'áƒáƒ›áƒ˜áƒœáƒ“áƒ˜', 'áƒáƒ“áƒáƒáƒ¢áƒáƒªáƒ˜áƒ', 'áƒ›áƒáƒ®áƒ áƒ˜áƒšáƒ˜'],
        shape: ['áƒáƒ•áƒ—áƒ”áƒœáƒ¢áƒ£áƒ áƒ˜', 'áƒœáƒáƒ›áƒ“áƒ•áƒ˜áƒšáƒ˜', 'áƒ—áƒáƒ•áƒ˜', 'áƒ˜áƒ“áƒ”áƒœáƒ¢áƒáƒ‘áƒ', 'áƒ•áƒ˜áƒœ áƒ•áƒáƒ ', 'áƒ£áƒœáƒ˜áƒ™áƒáƒšáƒ£áƒ áƒ˜', 'áƒ’áƒáƒœáƒ¡áƒ®áƒ•áƒáƒ•áƒ”áƒ‘áƒ£áƒšáƒ˜', 'áƒ áƒ”áƒáƒšáƒ£áƒ áƒ˜', 'áƒ›áƒ”', 'áƒáƒ•áƒ—áƒ”áƒœáƒ¢áƒ£áƒ áƒáƒ‘áƒ', 'áƒ˜áƒœáƒ“áƒ˜áƒ•áƒ˜áƒ“áƒ£áƒáƒšáƒ£áƒ áƒ˜', 'áƒœáƒáƒ›áƒ“áƒ•áƒ˜áƒšáƒ˜ áƒ—áƒáƒ•áƒ˜', 'áƒ’áƒ£áƒšáƒ¬áƒ áƒ¤áƒ”áƒšáƒ˜', 'áƒ¬áƒ áƒ¤áƒ”áƒšáƒ˜', 'áƒ­áƒ”áƒ¨áƒ›áƒáƒ áƒ˜áƒ¢áƒ˜'],
        seasons: ['áƒªáƒ˜áƒ™áƒšáƒ˜', 'áƒ¡áƒ”áƒ–áƒáƒœáƒ˜', 'áƒªáƒ•áƒšáƒ˜áƒšáƒ”áƒ‘áƒ', 'áƒ¤áƒáƒ–áƒ', 'áƒáƒ”áƒ áƒ˜áƒáƒ“áƒ˜', 'áƒ“áƒ áƒ', 'áƒ áƒ˜áƒ¢áƒ›áƒ˜', 'áƒœáƒ˜áƒ›áƒ£áƒ¨áƒ˜', 'áƒ’áƒáƒ›áƒ”áƒáƒ áƒ”áƒ‘áƒ', 'áƒ“áƒáƒ‘áƒ áƒ£áƒœáƒ”áƒ‘áƒ', 'áƒ’áƒáƒ–áƒáƒ¤áƒ®áƒ£áƒšáƒ˜', 'áƒ–áƒáƒ¤áƒ®áƒ£áƒšáƒ˜', 'áƒ–áƒáƒ›áƒ—áƒáƒ áƒ˜', 'áƒ¨áƒ”áƒ›áƒáƒ“áƒ’áƒáƒ›áƒ', 'áƒ áƒ˜áƒ—áƒ›áƒ˜'],
        wholeness: ['áƒ™áƒ£áƒ áƒœáƒáƒ•áƒ¡', 'áƒ›áƒ—áƒšáƒ˜áƒáƒœáƒ˜', 'áƒ¡áƒ áƒ£áƒšáƒ˜', 'áƒ˜áƒœáƒ¢áƒ”áƒ’áƒ áƒáƒªáƒ˜áƒ', 'áƒœáƒáƒ¢áƒ”áƒ®áƒ˜', 'áƒ’áƒáƒ¢áƒ”áƒ®áƒ˜áƒšáƒ˜', 'áƒáƒ¦áƒ“áƒ’áƒ”áƒœáƒ', 'áƒ™áƒ£áƒ áƒœáƒáƒ•áƒ¡', 'áƒáƒ™áƒ”áƒ—áƒ”áƒ‘áƒ¡', 'áƒ˜áƒœáƒ¢áƒ”áƒ’áƒ áƒáƒªáƒ˜áƒ', 'áƒ›áƒ—áƒ”áƒšáƒ˜', 'áƒ¡áƒ˜áƒ›áƒ áƒ—áƒ”áƒšáƒ”', 'áƒ¡áƒ˜áƒ¡áƒ áƒ£áƒšáƒ”'],
        patience: ['áƒ›áƒáƒšáƒáƒ“áƒ˜áƒœáƒ˜', 'áƒ›áƒáƒ—áƒ›áƒ˜áƒœáƒ”áƒ‘áƒ', 'áƒœáƒ”áƒšáƒ˜', 'áƒ“áƒ áƒ', 'áƒáƒ áƒáƒªáƒ”áƒ¡áƒ˜', 'áƒ—áƒáƒœáƒ“áƒáƒ—áƒáƒœ', 'áƒ’áƒáƒœáƒ•áƒ˜áƒ—áƒáƒ áƒ”áƒ‘áƒ', 'áƒ–áƒ áƒ“áƒ', 'áƒ’áƒáƒ¨áƒšáƒ', 'áƒ›áƒáƒ—áƒ›áƒ˜áƒœáƒ”áƒ‘áƒ', 'áƒ›áƒáƒ—áƒ›áƒ”áƒœáƒ', 'áƒšáƒáƒ“áƒ˜áƒœáƒ˜', 'áƒ—áƒáƒœáƒ“áƒáƒ—áƒáƒœáƒáƒ‘áƒ˜áƒ—', 'áƒªáƒ“áƒ', 'áƒ”áƒšáƒ˜', 'áƒœáƒ”áƒšáƒ'],
        presence: ['áƒáƒ®áƒšáƒ', 'áƒáƒ¬áƒ›áƒ§áƒ', 'áƒ§áƒ£áƒ áƒáƒ“áƒ¦áƒ”áƒ‘áƒ˜áƒáƒœáƒ˜', 'áƒ˜áƒªáƒ˜áƒ¡', 'áƒ›áƒáƒ›áƒ”áƒœáƒ¢áƒ˜', 'áƒáƒ¥', 'áƒ“áƒ¦áƒ”áƒ¡', 'áƒ§áƒ£áƒ áƒáƒ“áƒ¦áƒ”áƒ‘áƒ', 'áƒ¤áƒáƒ™áƒ£áƒ¡áƒ˜', 'áƒ›áƒ˜áƒ›áƒ“áƒ˜áƒœáƒáƒ áƒ”', 'áƒ§áƒ£áƒ áƒáƒ“áƒ¦áƒ”áƒ‘áƒ˜áƒáƒœáƒáƒ‘áƒ', 'áƒáƒ®áƒšáƒ']
    }
};
            

        // Tree visual Stages 

        const treeStages = {
    en: [
        `ğŸŒ±
    Your seed
 is planted with
    intention`,
        
        `       ğŸŒ¿
      /  \\
     /    \\
    /______\\
      |  |
     ~~~~~`,
        
        `       ğŸŒ³
      /ğŸƒ\\
     /    \\
    /      \\
   /________\\
      |||
    ~~~~~~~`,
        
        `       ğŸŒ³ğŸŒ³
      /    \\
     /      \\
    /        \\
   /          \\
  /____________\\
      |||||
    ~~~~~~~~~`,
        
        `     ğŸŒ³ WISDOM ğŸŒ³
    /           \\
   /   RINGS OF  \\
  /    GROWTH     \\
 /                 \\
/___________________\\
      |||||||
   ~~~~~~~~~~~~`

     /* `      ğŸŒ³ğŸŒ² SAGE ğŸŒ²ğŸŒ³
     /               \\
    /   WISDOM OF     \\
   /     AGES PAST     \\
  /                     \\
 /                       \\
/_________________________\\
        ||||||||
     ~~~~~~~~~~~~~~`*/
    ],
    
    ge: [
        `ğŸŒ±
  áƒœáƒ”áƒ áƒ’áƒ˜
áƒ“áƒáƒ áƒ’áƒ£áƒšáƒ˜áƒ`,
        
        `       ğŸŒ¿
      /  \\
     /    \\
    /______\\
      |  |
     ~~~~~`,
        
        `       ğŸŒ³
      /ğŸƒ\\
     /    \\
    /      \\
   /________\\
      |||
    ~~~~~~~`,
        
        `       ğŸŒ³ğŸŒ³
      /    \\
     /      \\
    /        \\
   /          \\
  /____________\\
      |||||
    ~~~~~~~~~`,
        
        `     ğŸŒ³ áƒ¡áƒ˜áƒ‘áƒ áƒ«áƒœáƒ” ğŸŒ³
    /           \\
   /   áƒ–áƒ áƒ“áƒ˜áƒ¡    \\
  /    áƒ áƒ’áƒáƒšáƒ”áƒ‘áƒ˜   \\
 /                \\
/__________________\\
      |||||||
   ~~~~~~~~~~~~`

        /*`      ğŸŒ³ğŸŒ² áƒ‘áƒ áƒ«áƒ”áƒœáƒ˜ ğŸŒ²ğŸŒ³
     /               \\
    /   áƒ®áƒáƒœáƒ˜áƒ¡         \\
   /     áƒ¡áƒ˜áƒ‘áƒ áƒ«áƒœáƒ”       \\
  /                     \\
 /                       \\
/_________________________\\
        ||||||||
     ~~~~~~~~~~~~~~`*/
    ]
};
        
        // ==================== INITIALIZATION ====================
        
  document.addEventListener('DOMContentLoaded', function() {
    loadTree();
    detectLanguage(); 
    initTheme(); 
    updateUI();
    preserveUserDataOnUpdate();
    checkVersionAndPreserveData();
    checkAppVersion();
    loadPrinciples();
    updateDisplay();
    
    // DELAY showing the card to ensure everything is loaded
    setTimeout(function() {
        showCard('welcome');
    }, 100);
});
        
        // ==================== LANGUAGE FUNCTIONS ====================
        
        function detectLanguage() {
            // Check saved preference first
            const savedLang = localStorage.getItem(LANG_KEY);
            
            if (savedLang) {
                currentLanguage = savedLang;
            } else {
                // Auto-detect based on browser
                const browserLang = navigator.language || navigator.userLanguage;
                
                if (browserLang.startsWith('ka') || browserLang.startsWith('ge')) {
                    currentLanguage = 'ge';
                } else {
                    currentLanguage = 'en';
                }
                
                // Save detected language
                localStorage.setItem(LANG_KEY, currentLanguage);
            }
            
            // Update body class for Georgian font
            if (currentLanguage === 'ge') {
                document.body.classList.add('georgian-lang');
            } else {
                document.body.classList.remove('georgian-lang');
            }
        }

        // =========== THEME MANAGEMENT =============
        const THEME_KEY = 'forestTheme';

        // Initialize theme
        function initTheme() {
            const savedTheme = localStorage.getItem(THEME_KEY);
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    
            // Priority: saved preference > system preference > light
            const theme = savedTheme || (prefersDark ? 'dark' : 'light');
    
            setTheme(theme);
            updateThemeButton();
        }

        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem(THEME_KEY, theme);
            updateThemeButton();
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            setTheme(newTheme);
        }

        function updateThemeButton() {
            const button = document.getElementById('theme-toggle');
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
            button.innerHTML = currentTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
            
            /*if (currentTheme === 'dark') {
                button.innerHTML = 'â˜€ï¸';
                button.title = 'Switch to light mode';
            } else {
                button.innerHTML = 'ğŸŒ™';
                button.title = 'Switch to dark mode';
            }*/
        }
        
        function toggleLanguage() {
            // Switch language
            currentLanguage = currentLanguage === 'en' ? 'ge' : 'en';
            
            // Save preference
            localStorage.setItem(LANG_KEY, currentLanguage);
            
            // Update body class
            if (currentLanguage === 'ge') {
                document.body.classList.add('georgian-lang');
            } else {
                document.body.classList.remove('georgian-lang');
            }
            
            updateUI();
            
            loadPrinciples();
            
            updateSeedPreview();
            
            // Update practice card if needed
            if (document.getElementById('practiceContent').style.display !== 'none') {
                updatePracticeCard();
            }
            // If canopy card is active, reload its wisdom buttons
            if (document.getElementById('canopy')?.classList.contains('active')) {
                initCanopyPractice(); 
            }
        }


        function updateUI() {
    const t = TEXT[currentLanguage];
    
    // Helper function with proper property handling
    function safeUpdate(id, property, value) {
        const element = document.getElementById(id);
        if (!element) return; // Skip if element doesn't exist
        
        // Handle different property types correctly
        if (property === 'innerHTML') {
            element.innerHTML = value;
        } else if (property === 'placeholder') {
            element.placeholder = value;
        } else if (property === 'textContent') {
            element.textContent = value;
        } else {
            // Default to setting property directly
            element[property] = value;
        }
    }
    
    // Update navigation
    safeUpdate('nav-welcome', 'textContent', t.navWelcome);
    safeUpdate('nav-plant', 'textContent', t.navPlant);
    safeUpdate('nav-practice', 'textContent', t.navPractice);
    safeUpdate('nav-forest', 'textContent', t.navForest);
    safeUpdate('nav-journal', 'textContent', t.navJournal);
    
    // Update app titles
    safeUpdate('app-title', 'textContent', t.appTitle);
    safeUpdate('app-tagline', 'textContent', t.appTagline);
    safeUpdate('app-subtitle', 'textContent', t.appSubtitle);
    
    // Update welcome card
    safeUpdate('welcome-title', 'textContent', t.welcomeTitle);
    safeUpdate('welcome-text', 'innerHTML', t.welcomeText);
    safeUpdate('principles-title', 'textContent', t.principlesTitle);
    safeUpdate('how-it-works', 'innerHTML', t.howItWorks);
    safeUpdate('start-journey-btn', 'textContent', t.startJourneyBtn);
    
    // Update plant tree card
    safeUpdate('plant-title', 'textContent', t.plantTitle);
    safeUpdate('plant-text', 'textContent', t.plantText);
    safeUpdate('treeName', 'placeholder', t.treeNamePlaceholder);
    safeUpdate('plant-btn', 'textContent', t.plantBtn);
    safeUpdate('demo-btn', 'textContent', t.demoBtn);
    
    // Update practice card
    safeUpdate('practice-title', 'textContent', t.practiceTitle);
    safeUpdate('practiceStatus', 'textContent', t.practiceStatus);
    safeUpdate('step1-title', 'textContent', t.step1Title);
    safeUpdate('step1-text', 'textContent', t.step1Text);
    safeUpdate('step2-title', 'textContent', t.step2Title);
    safeUpdate('step3-title', 'textContent', t.step3Title);
    safeUpdate('step3-text', 'textContent', t.step3Text);
    safeUpdate('practiceJournal', 'placeholder', t.practiceJournalPlaceholder);
    safeUpdate('nextBtn1', 'textContent', t.nextBtn);
    safeUpdate('prev-btn', 'textContent', t.prevBtn);
    safeUpdate('next-btn2', 'textContent', t.nextBtn);
    safeUpdate('prev-btn2', 'textContent', t.prevBtn);
    safeUpdate('complete-btn', 'textContent', t.completeBtn);
    // SKIP: view-journal-btn (doesn't exist)
    
    // Update forest card
    safeUpdate('forest-title', 'textContent', t.forestTitle);
    safeUpdate('start-practice-btn', 'textContent', t.startPracticeBtn);
    safeUpdate('stat-rings-label', 'textContent', t.statRingsLabel);
    safeUpdate('stat-stage-label', 'textContent', t.statStageLabel);
    safeUpdate('stat-journals-label', 'textContent', t.statJournalsLabel);
    safeUpdate('stat-poems-label', 'textContent', t.statPoemsLabel);
    safeUpdate('become-canopy-btn', 'textContent', t.becomeCanopyBtn);
            
    // Update journal card
    safeUpdate('journal-title', 'textContent', t.journalTitle);
    safeUpdate('journal-subtitle', 'textContent', t.journalSubtitle);
    // SKIP: new-entry-title (doesn't exist)
    safeUpdate('newJournalEntry', 'placeholder', t.journalPlaceholder);
    safeUpdate('save-entry-btn', 'textContent', t.saveEntryBtn);
    safeUpdate('clear-btn', 'textContent', t.clearBtn);
    safeUpdate('journey-title', 'textContent', t.journeyTitle); 
    safeUpdate('new-entry-title', 'textContent', t.newEntryTitle);
    
    // Update footer
    safeUpdate('footer-version', 'textContent', t.footerVersion);
    safeUpdate('footer-data', 'textContent', t.footerData);
    safeUpdate('footer-quote', 'innerHTML', `<em>${t.footerQuote}</em>`);
    safeUpdate('install-text', 'textContent', t.installBtn);
    safeUpdate('footer-creator', 'textContent', t.footerCreator);
    safeUpdate('footer-book', 'textContent', t.footerBook);
            
    // Update canopy card titles
    safeUpdate('canopy-title', 'textContent', t.canopyTitle);
    safeUpdate('canopy-subtitle', 'textContent', t.canopySubtitle);
    safeUpdate('canopy-step1-title', 'textContent', t.canopyStep1Title);
    safeUpdate('canopy-step1-text', 'textContent', t.canopyStep1Text);
    safeUpdate('canopy-step2-title', 'textContent', t.canopyStep2Title);
    safeUpdate('canopy-step3-title', 'textContent', t.canopyStep3Title);
    safeUpdate('canopy-step3-text', 'textContent', t.canopyStep3Text);
    safeUpdate('canopyJournal', 'placeholder', t.canopyJournalPlaceholder);

    // Update canopy buttons
    safeUpdate('canopyNextBtn1', 'textContent', t.nextBtn);
    safeUpdate('canopyPrevBtn', 'textContent', t.prevBtn);
    safeUpdate('canopyNextBtn2', 'textContent', t.nextBtn);
    safeUpdate('canopyPrevBtn2', 'textContent', t.prevBtn);
    safeUpdate('canopyCompleteBtn', 'textContent', t.canopyCompleteBtn);
    safeUpdate('canopyViewJournalBtn', 'textContent', t.viewJournalBtn || 'View in Journal');

    // Update canopy status message
    const statusElement = document.getElementById('canopyStatus');
    if (statusElement) {
        statusElement.textContent = currentLanguage === 'ge' 
        ? 'áƒáƒ˜áƒ áƒ©áƒ˜áƒ”áƒ— áƒ¡áƒáƒ©áƒ áƒ“áƒ˜áƒšáƒáƒ‘áƒšáƒ˜áƒ¡ áƒ¨áƒ”áƒ®áƒ”áƒ“áƒ£áƒšáƒ”áƒ‘áƒ' 
        : 'Select a canopy insight to begin practice';
    }

    // Update the "New Practice" button in canopy result
    const canopyNewPracticeBtn = document.querySelector('#canopyResult button.secondary');
    if (canopyNewPracticeBtn) {
        canopyNewPracticeBtn.textContent = currentLanguage === 'ge' ? 'áƒáƒ®áƒáƒšáƒ˜ áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ˜' : 'New Practice';
    }
            
    // Update tree display if no tree
    if (!myTree.name) {
        safeUpdate('treeNameDisplay', 'textContent', t.noTree);
        safeUpdate('treeAscii', 'textContent', t.plantToBegin);
        /*safeUpdate('progressText', 'textContent', "0/6");*/
    }
    
    // Update language toggle button
    safeUpdate('lang-toggle', 'textContent', 'ğŸŒ ' + (currentLanguage === 'en' ? 'ENG/GE' : 'GE/ENG'));
    // Update seed preview text
    updateSeedPreview();
}
      
      
        function updateSeedPreview() {
            const seedPreviews = {
                en: `       ğŸŒ±
      Your seed
     is planted with
      intention`,
        
                ge: `       ğŸŒ±
    áƒœáƒ”áƒ áƒ’áƒ˜
   áƒ¨áƒ—áƒáƒœáƒ”áƒ áƒ’áƒ•áƒ˜áƒ—
    áƒ˜áƒ áƒ’áƒ•áƒ”áƒ‘áƒ`
            };
    
            const previewElement = document.getElementById('seedPreview').querySelector('pre');
            if (previewElement) {
                previewElement.textContent = seedPreviews[currentLanguage];
            }
        }
        
        
        function loadPrinciples() {
            const container = document.getElementById('principlesList');
            container.innerHTML = '';
            
            const principles = principlesData[currentLanguage];
            principles.forEach(p => {
                container.innerHTML += `
                    <div class="principle-badge">
                        <strong>${p.emoji} ${p.title}</strong><br>
                        <small>${p.description}</small>
                    </div>
                `;
            });
        }
        
        // ==================== CORE APP FUNCTIONS ====================
        
  function showCard(cardId) {
    console.log("showCard called:", cardId);
    
    // Hide all cards - WITH NULL CHECK
    const cards = document.querySelectorAll('.card');
    if (cards.length > 0) {
        cards.forEach(card => {
            card.classList.remove('active');
        });
    }
    
    // Show selected card - WITH NULL CHECK
    const selectedCard = document.getElementById(cardId);
    if (selectedCard) {
        selectedCard.classList.add('active');
        
        // Special updates
        if (cardId === 'practice') updatePracticeCard();
        if (cardId === 'forest') updateForestCard();
        if (cardId === 'journal') loadJournalEntries();
        
        console.log("Successfully showed card:", cardId);
    } else {
        console.error("Card not found:", cardId);
    }
        }
        
        
        function plantTree() {
            const name = document.getElementById('treeName').value.trim();
            const t = TEXT[currentLanguage];
            
            if (!name) {
                alert(t.alertNameTree);
                return;
            }
            
            myTree.name = name;
            myTree.plantedDate = new Date().toLocaleDateString();
           // myTree.rings = 0;
           // myTree.stage = 1;
            
            // Save to browser storage
            saveTree();
            
            // Show success
            alert(t.alertTreePlanted.replace('{name}', name));
            showCard('practice');
            updatePracticeCard();
            //updateForestcard();
        }
        
        function loadDemoTree() {
            document.getElementById('treeName').value = currentLanguage === 'en' ? "Serenity Oak" : "áƒ›áƒ¨áƒ•áƒ˜áƒ“áƒáƒ‘áƒ˜áƒ¡ áƒ›áƒ£áƒ®áƒ";
            plantTree();
        }
        
        function loadTree() {
            const saved = localStorage.getItem('forestTree');
            if (saved) {
                myTree = JSON.parse(saved);
                
                // Ensure backward compatibility
                myTree.lastPracticePrinciple = myTree.lastPracticePrinciple || null;
                myTree.poemUsage = myTree.poemUsage || {};
                myTree.shownPoemsByCategory = myTree.shownPoemsByCategory || {
                    rooting: [], bark: [], rings: [], release: [], reaching: [],
                    network: [], bending: [], shape: [], seasons: [], wholeness: [],
                    patience: [], presence: []
                };
            }
        }
        
// ==================== DATA PRESERVATION ON UPDATE ====================
// Add this AFTER your existing loadTree() function (around line ~260)

function preserveUserDataOnUpdate() {
    // 1. Always create a backup when app starts
    const backupKey = 'forest_user_backup_' + APP_VERSION;
    localStorage.setItem(backupKey, JSON.stringify(myTree));
    
    // 2. Check for old backups from previous versions
    const oldKeys = Object.keys(localStorage).filter(key => 
        key.startsWith('forest_user_backup_') && key !== backupKey
    );
    
    // 3. If current tree is empty but we have old backups, restore
    if ((!myTree.name || myTree.journals.length === 0) && oldKeys.length > 0) {
        // Get the most recent backup
        const latestKey = oldKeys[oldKeys.length - 1];
        const backup = JSON.parse(localStorage.getItem(latestKey));
        
        if (backup && backup.name) {
            console.log('ğŸŒ³ Restoring from backup:', latestKey);
            
            // Preserve core data
            myTree.name = backup.name || myTree.name;
            myTree.plantedDate = backup.plantedDate || myTree.plantedDate;
            myTree.rings = backup.rings || myTree.rings;
            myTree.stage = backup.stage || myTree.stage;
            myTree.journals = backup.journals || myTree.journals;
            myTree.practices = backup.practices || myTree.practices;
            myTree.poemsReceived = backup.poemsReceived || myTree.poemsReceived;
            
            // Preserve poem history if it exists
            if (backup.shownPoemsByCategory) {
                myTree.shownPoemsByCategory = backup.shownPoemsByCategory;
            }
            if (backup.poemUsage) {
                myTree.poemUsage = backup.poemUsage;
            }
            
            saveTree();
        }
    }
    
    // 4. Clean up old backups (keep last 3 versions)
    if (oldKeys.length > 3) {
        oldKeys.slice(0, -3).forEach(key => {
            localStorage.removeItem(key);
        });
    }
}

// ==================== SIMPLE VERSION CHECK ====================
function checkVersionAndPreserveData() {
    const lastVersion = localStorage.getItem('forest_last_version');
    
    // If version changed, make extra backup
    if (lastVersion !== APP_VERSION) {
        console.log('ğŸŒ³ Version change detected:', lastVersion, 'â†’', APP_VERSION);
        
        // Create version-specific backup
        const versionBackupKey = `forest_v${lastVersion || '1.0'}_backup`;
        localStorage.setItem(versionBackupKey, JSON.stringify(myTree));
        
        // Update version
        localStorage.setItem('forest_last_version', APP_VERSION);
        
        // Ensure new properties exist
        if (!myTree.shownPoemsByCategory) {
            myTree.shownPoemsByCategory = {
                rooting: [], bark: [], rings: [], release: [], reaching: [],
                network: [], bending: [], shape: [], seasons: [], wholeness: [],
                patience: [], presence: []
            };
        }
        if (!myTree.poemUsage) {
            myTree.poemUsage = {};
        }
        
        saveTree();
    }
}
        function updatePracticeCard() {
            const t = TEXT[currentLanguage];
            const status = document.getElementById('practiceStatus');
            const content = document.getElementById('practiceContent');
            const result = document.getElementById('practiceResult');
            
            if (!myTree.name) {
                status.innerHTML = `ğŸŒ± <strong>${t.practiceStatus}</strong> ${t.plantBtn}`;
                content.style.display = 'none';
                result.style.display = 'none';
                return;
            }
            
            status.style.display = 'none';
            content.style.display = 'block';
            result.style.display = 'none';
            
            // Reset to step 1
            currentStep = 1;
            document.querySelectorAll('.step').forEach(step => step.style.display = 'none');
            document.getElementById('step1').style.display = 'block';
            selectedPrinciple = null;
            document.getElementById('practiceJournal').value = "";
            
            // Load principle buttons
            const container = document.getElementById('principleButtons');
            container.innerHTML = '';
            const principles = principlesData[currentLanguage];
            principles.forEach(p => {
                container.innerHTML += `
                    <div class="principle-badge" onclick="selectPrinciple('${p.id}')" id="principle-${p.id}">
                        <strong>${p.emoji} ${p.title}</strong><br>
                        <small>${p.description}</small>
                    </div>
                `;
            });
        }
        
        function selectPrinciple(id) {
            selectedPrinciple = id;
            
            // Update UI
            document.querySelectorAll('.principle-badge').forEach(badge => {
                badge.classList.remove('selected');
            });
            document.getElementById(`principle-${id}`).classList.add('selected');
            
            // Enable next button
            document.getElementById('nextBtn1').disabled = false;
        }
        
        function nextStep() {
            const t = TEXT[currentLanguage];
            
            if (currentStep === 1 && !selectedPrinciple) {
                alert(t.alertSelectPrinciple);
                return;
            }
            
            // Hide current step
            document.getElementById(`step${currentStep}`).style.display = 'none';
            
            // Show next step
            currentStep++;
            document.getElementById(`step${currentStep}`).style.display = 'block';
            
            // Load exercise if going to step 2
            if (currentStep === 2 && selectedPrinciple) {
                const principles = principlesData[currentLanguage];
                const principle = principles.find(p => p.id === selectedPrinciple);
                document.getElementById('exerciseContent').innerHTML = principle.exercise;
            }
        }
        
        function prevStep() {
            // Hide current step
            document.getElementById(`step${currentStep}`).style.display = 'none';
            
            // Show previous step
            currentStep--;
            document.getElementById(`step${currentStep}`).style.display = 'block';
        }
        
        // Enhanced poem selection with language support
        
        function getContextualPoem(journalText, practicePrinciple = null) {
            const text = journalText.toLowerCase();
            const lang = currentLanguage;

            // ADD THIS MAPPING OBJECT:
            const principleToCategory = {
                'root': 'rooting',        // "Root First" â†’ rooting category
                'bark': 'bark',           // "Bark Boundaries" â†’ bark category
                'rings': 'rings',         // "Grow Rings" â†’ rings category
                'release': 'release',     // "Seasonal Release" â†’ release category
                'light': 'reaching',      // "Reach for Light" â†’ reaching category
                'network': 'network',     // "Forest Network" â†’ network category
                'bend': 'bending',        // "Bend in Storms" â†’ bending category
                'shape': 'shape'          // "Your True Shape" â†’ shape category
                // Note: seasons, wholeness, patience, presence have no corresponding principles
            };

            // Get appropriate keywords for current language
            const keywords = categoryKeywords[lang];
            
            // Determine keyword matching scores for each category
            let categoryScores = {};
            let keywordMatches = {};
            
            for (const [cat, catKeywords] of Object.entries(keywords)) {
                let score = 0;
                let matches = [];
                
                catKeywords.forEach(keyword => {
                    if (text.includes(keyword)) {
                        score += 2;
                        matches.push(keyword);
                        
                        // Bonus for exact phrase matches
                        if (text.includes(` ${keyword} `) || 
                            text.startsWith(`${keyword} `) || 
                            text.endsWith(` ${keyword}`)) {
                            score += 1;
                        }
                    }
                });
                
                categoryScores[cat] = score;
                keywordMatches[cat] = matches;
            }
            
            // Get top categories (sort by score)
            const sortedCategories = Object.entries(categoryScores)
                .sort((a, b) => b[1] - a[1])
                .filter(([cat, score]) => score > 0);
            
            // Get highest scoring category
            const highestCategory = sortedCategories.length > 0 ? sortedCategories[0][0] : 'rooting';
            
            // Determine which category to prioritize (latest practice or highest keyword)
            // const priorityCategory = practicePrinciple || highestCategory;
            
            // Fixed: map practice principle to category
            const practiceCategory = practicePrinciple ? principleToCategory[practicePrinciple] : null;
            const priorityCategory = practiceCategory || highestCategory;
            
            // Prepare list of all poems with scores
            let poemCandidates = [];
            
            // Get poems for current language
            const poems = poeticWisdom[lang];
            
            // Score all poems across all categories
            for (const [category, poemList] of Object.entries(poems)) {
                poemList.forEach((poemObj, index) => {
                    const poemId = poemObj.id;
                    const usageCount = myTree.poemUsage[poemId] || 0;
                    const hasBeenShownTwice = usageCount >= 2;
                    
                    // Skip poems shown twice (according to your requirement)
                    if (hasBeenShownTwice) {
                        return;
                    }
                    
                    let score = 0;
                    const isUnseen = usageCount === 0;
                    
                    // Priority 1: Latest practice principle + unseen (100 points)
                    if (category === priorityCategory && isUnseen) {
                        score = 100;
                    }
                    // Priority 2: Exact match + unseen (80 points)
                    else if (category === highestCategory && isUnseen) {
                        score = 80;
                    }
                    // Priority 3: Same category + unseen (70 points)
                    else if (category === highestCategory && isUnseen) {
                        score = 70;
                    }
                    // Priority 4: Different category + high keyword match + unseen (60 points)
                    else if (categoryScores[category] > 0 && isUnseen) {
                        score = 60;
                    }
                    // Priority 5: Exact match + seen once (50 points)
                    else if (category === highestCategory && usageCount === 1) {
                        score = 50;
                    }
                    // Fallback: Random (10 points)
                    else {
                        score = 10;
                    }
                    
                    // Bonus for poems that contain user's keywords in the poem text
                    const poemText = poemObj.poem.toLowerCase();
                    keywordMatches[category]?.forEach(keyword => {
                        if (poemText.includes(keyword)) {
                            score += 5;
                        }
                    });
                    
                    poemCandidates.push({
                        poem: poemObj,
                        score: score,
                        category: category,
                        poemId: poemId,
                        usageCount: usageCount,
                        isUnseen: isUnseen
                    });
                });
            }
            
            // Sort by score (highest first)
            poemCandidates.sort((a, b) => b.score - a.score);
            
            // If no candidates (all poems shown twice), fallback to random from highest category
            if (poemCandidates.length === 0) {
                const fallbackPoems = poems[highestCategory] || poems.rooting;
                const randomIndex = Math.floor(Math.random() * fallbackPoems.length);
                const fallbackPoem = fallbackPoems[randomIndex];
                return {
                    poem: fallbackPoem.poem,
                    sage: fallbackPoem.sage,
                    category: highestCategory,
                    poemId: fallbackPoem.id
                };
            }
            
            // Select top scoring poem
            const selectedCandidate = poemCandidates[0];
            
            // Update usage tracking
            const poemId = selectedCandidate.poemId;
            myTree.poemUsage[poemId] = (myTree.poemUsage[poemId] || 0) + 1;
            
            // Track by category
            if (!myTree.shownPoemsByCategory[selectedCandidate.category].includes(poemId)) {
                myTree.shownPoemsByCategory[selectedCandidate.category].push(poemId);
            }
            
            return {
                poem: selectedCandidate.poem.poem,
                sage: selectedCandidate.poem.sage,
                category: selectedCandidate.category,
                poemId: poemId,
                score: selectedCandidate.score
            };
        }
        
        function completePractice() {
            const t = TEXT[currentLanguage];
            
            if (!myTree.name) {
                alert(t.alertPlantFirst);
                showCard('plant');
                return;
            }
            
            if (!selectedPrinciple) {
                alert(t.alertSelectPrinciple);
                return;
            }
            
            const journalText = document.getElementById('practiceJournal').value.trim();
            const principles = principlesData[currentLanguage];
            const principle = principles.find(p => p.id === selectedPrinciple);
            
            if (!journalText) {
                alert(t.alertWriteJournal);
                return;
            }
            
            // Get contextual poem with practice principle
            const poem = getContextualPoem(journalText, principle.id);
            
            // Update last practice principle
            myTree.lastPracticePrinciple = principle.id;
            
            // Add practice
            myTree.practices.push({
                date: new Date().toLocaleString(),
                principle: principle.title,
                journal: journalText
            });
            
            // Grow tree
            myTree.rings++;
            myTree.poemsReceived++;
            
            // Update stage based on rings
            if (myTree.rings === 0) myTree.stage = 0;
            else if (myTree.rings < 4) myTree.stage = 1;
            else if (myTree.rings < 8) myTree.stage = 2;
            else if (myTree.rings < 13) myTree.stage = 3;
            else if (myTree.rings < 18) myTree.stage = 4; 
           // else if (myTree.rings < 32) myTree.stage = 5;
            else myTree.stage = 5;
            
            // Add to journals
            myTree.journals.push({
                date: new Date().toLocaleString(),
                text: journalText,
                poem: poem.poem,
                sage: poem.sage,
                principle: principle.title,
                type: 'practice',
            });
            
            // Save
            saveTree();
            updateDisplay();
            
            // Show poem
            document.getElementById('practiceContent').style.display = 'none';
            document.getElementById('practiceResult').style.display = 'block';
            
            document.getElementById('poemText').innerHTML = poem.poem.replace(/\n/g, '<br>');
            document.getElementById('sageQuote').textContent = poem.sage;
            
            document.getElementById('resultMessage').innerHTML = 
                t.practiceComplete
                    .replace('{principle}', principle.title)
                    .replace('{stage}', myTree.stage);
            
            // Auto-redirect to journal after 3 seconds
            setTimeout(() => {
                showCard('journal');
                loadJournalEntries();
            }, 3000);
        }

        // =========== CANOPY FUNCTIONS ============

function showCanopyCard() {
    showCard('canopy');
    initCanopyPractice();
}

function initCanopyPractice() {
    const t = TEXT[currentLanguage];
    const status = document.getElementById('canopyStatus');
    
    if (!myTree.name) {
        status.innerHTML = `ğŸŒ± <strong>${t.practiceStatus}</strong> ${t.plantBtn}`;
        return;
    }
    
    status.style.display = 'none';
    
    // Reset to step 1
    canopyCurrentStep = 1;
    selectedCanopyInsight = null;
    
    // Hide all steps and result
    document.getElementById('canopyStep1').style.display = 'none';
    document.getElementById('canopyStep2').style.display = 'none';
    document.getElementById('canopyStep3').style.display = 'none';
    document.getElementById('canopyResult').style.display = 'none';
    
    // Show step 1
    document.getElementById('canopyStep1').style.display = 'block';
    document.getElementById('canopyJournal').value = "";
    
    // DISABLE the Next button initially
    document.getElementById('canopyNextBtn1').disabled = true;
    
    // Load canopy insight buttons
    const container = document.getElementById('canopyButtons');
    container.innerHTML = '';
    const insights = canopyWisdom[currentLanguage];
    insights.forEach(insight => {
        container.innerHTML += `
            <div class="principle-badge" onclick="selectCanopyInsight('${insight.id}')" id="canopy-${insight.id}">
                <strong>ğŸŒ¤ï¸ ${insight.title}</strong><br>
                <small>${insight.practice.split(/[.!?]/)[0].trim()}</small>
            </div>
        `;
    });
}

function selectCanopyInsight(id) {
    selectedCanopyInsight = id;
    
    // Update UI
    document.querySelectorAll('#canopyButtons .principle-badge').forEach(badge => {
        badge.classList.remove('selected');
    });
    document.getElementById(`canopy-${id}`).classList.add('selected');
    
    // Enable next button
    document.getElementById('canopyNextBtn1').disabled = false;
}

function canopyNextStep() {
    const t = TEXT[currentLanguage];
    
    if (canopyCurrentStep === 1 && !selectedCanopyInsight) {
        alert(t.alertSelectPrinciple);
        return;
    }
    // Hide current step
    document.getElementById(`canopyStep${canopyCurrentStep}`).style.display = 'none';
    // Show next step
    canopyCurrentStep++;
    document.getElementById(`canopyStep${canopyCurrentStep}`).style.display = 'block';
    // Load insight and practice if going to step 2
    if (canopyCurrentStep === 2 && selectedCanopyInsight) {
        const insights = canopyWisdom[currentLanguage];
        const insight = insights.find(i => i.id === selectedCanopyInsight);
        document.getElementById('canopyExerciseContent').innerHTML = `
            <h4>${insight.title}</h4>
            <p>${insight.insight}</p>
            <br>
            <p><em><strong>${currentLanguage === 'ge' ? 'áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ˜' : 'Practice'}:</strong> ${insight.practice}</em></p>
        `;
    }
     // Show offering in Step 3
    if (canopyCurrentStep === 3 && selectedCanopyInsight) {
        const insights = canopyWisdom[currentLanguage];
        const insight = insights.find(i => i.id === selectedCanopyInsight);
        document.getElementById('canopyOfferingDisplay').innerHTML = `
            <p>${insight.offering}</p>
        `;
    }
}

function canopyPrevStep() {
    // Hide current step
    document.getElementById(`canopyStep${canopyCurrentStep}`).style.display = 'none';
    
    // Show previous step
    canopyCurrentStep--;
    document.getElementById(`canopyStep${canopyCurrentStep}`).style.display = 'block';
}

function completeCanopyPractice() {
    const t = TEXT[currentLanguage];
    
    if (!myTree.name) {
        alert(t.alertPlantFirst);
        showCard('plant');
        return;
    }
    
    if (!selectedCanopyInsight) {
        alert(t.alertSelectPrinciple);
        return;
    }
    
    const responseText = document.getElementById('canopyJournal').value.trim();
    if (!responseText) {
        alert(t.alertWriteJournal);
        return;
    }
    
    const insights = canopyWisdom[currentLanguage];
    const insight = insights.find(i => i.id === selectedCanopyInsight);
    
    // Save to journals - ONLY user's response
    myTree.journals.push({
        date: new Date().toLocaleString(),
        text: responseText,
        title: `ğŸŒ¤ï¸ ${insight.title}`,
        offering: insight.offering,
        type: 'canopy',
        insightId: insight.id,
        principle: insight.title
    });
    
    saveTree();
    
    // Show result
    document.getElementById('canopyStep3').style.display = 'none';
    document.getElementById('canopyResult').style.display = 'block';
    
    document.getElementById('canopyResultMessage').innerHTML = 
        `${currentLanguage === 'ge' ? 'âœ… áƒ•áƒáƒ áƒ¯áƒ˜áƒ¨áƒ˜ áƒ“áƒáƒ¡áƒ áƒ£áƒšáƒ“áƒ!' : 'âœ… Practice complete!'}<br>
        <strong>${currentLanguage === 'ge' ? 'áƒ¡áƒáƒ©áƒ áƒ“áƒ˜áƒšáƒáƒ‘áƒ”áƒšáƒ˜' : 'Canopy Insight'}:</strong> ${insight.title}<br>
        <em>${insight.offering}</em>`;
    
    document.getElementById('canopySageQuote').textContent = 
        currentLanguage === 'ge' 
            ? '"áƒ¡áƒáƒ©áƒ áƒ“áƒ˜áƒšáƒáƒ‘áƒ”áƒšáƒ˜ áƒ©áƒ áƒ“áƒ˜áƒšáƒ¡ áƒ“áƒáƒ©áƒ áƒ“áƒ˜áƒšáƒáƒ•áƒ¡"'
            : '"Canopy permission over shadow"';
}

function resetCanopyPractice() {
    initCanopyPractice();
}

function showJournalAndScrollToNewest() {
    showCard('journal');
    
    // Wait for journal to load, then scroll to top (newest entries are at top)
    setTimeout(() => {
        // Scroll the entire journal card to the top
        const journalCard = document.getElementById('journal');
        if (journalCard) {
            journalCard.scrollTop = 0;
        }
        
        // Also try to find and highlight canopy entries
        const canopyEntries = document.querySelectorAll('.journal-entry');
        if (canopyEntries.length > 0) {
            // Find the first canopy entry (should be newest)
            for (let entry of canopyEntries) {
                if (entry.querySelector('.entry-date span:last-child')?.textContent?.includes('ğŸŒ¤ï¸')) {
                    // This is a canopy entry
                    entry.scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                    });
                    
                    // Add temporary highlight
                    entry.style.backgroundColor = 'var(--principle-bg)';
                    setTimeout(() => {
                        entry.style.backgroundColor = '';
                    }, 2000);
                    break;
                }
            }
        }
    }, 300);
 }      
        
        function saveJournalEntry() {
            const t = TEXT[currentLanguage];
            
            // Check if tree exists
            if (!myTree.name) {
                alert(t.alertPlantFirst);  // Use existing alert message
                showCard('plant');  // Redirect to plant tree card
                return;
            }
            
            const text = document.getElementById('newJournalEntry').value.trim();
            
            if (!text) {
                alert(t.alertWriteSomething);
                return;
            }
            
            // Get contextual poem - use last practice principle if available
            const practicePrinciple = myTree.lastPracticePrinciple || null;
            const poem = getContextualPoem(text, practicePrinciple);
            myTree.poemsReceived++;
            
            myTree.journals.push({
                date: new Date().toLocaleString(),
                text: text,
                poem: poem.poem,
                sage: poem.sage,
                principle: "Journal Entry",
                type: 'journal',
            });
            
            saveTree();
            loadJournalEntries();
            
            // Clear field
            document.getElementById('newJournalEntry').value = "";
            
            // Scroll to show new entry
            const journalEntries = document.getElementById('journalEntries');
            if (journalEntries.firstChild) {
                // scroll to the actual newest entry (first element after reversal)
                journalEntries.firstChild.scrollIntoView({ behavior: 'smooth', block: 'start' });
                // journalEntries.firstChild.scrollIntoView({ behavior: 'smooth' });
            }
        }

    function loadJournalEntries() {
    const container = document.getElementById('journalEntries');
    const t = TEXT[currentLanguage];
    container.innerHTML = "";
    
    if (myTree.journals.length === 0) {
        container.innerHTML = `
            <div style="text-align: center; padding: 30px; color: #666; font-style: italic;">
                ${t.noEntries}
            </div>
        `;
        return;
    }
    
    // Show most recent first
    myTree.journals.slice().reverse().forEach((entry, index) => {
        // Calculate the original index (not reversed)
        const originalIndex = myTree.journals.length - 1 - index;
        
        if (entry.type === 'canopy') {
            // CANOPY ENTRY - Show only user response
            container.innerHTML += `
                <div class="journal-entry">
                    <div class="entry-date">
                        <span>${entry.date.split(',')[0]}</span>
                        <span style="text-align: right;">ğŸŒ¤ï¸ ${entry.principle || entry.title}</span>
                    </div>
                    <p>${entry.text}</p>
                    <!--<p style="font-style: italic; margin-top: 10px; color: var(--text-secondary);">
                        ${entry.offering || ''}
                    </p>-->
                    <div class="entry-footer">
                        <button onclick="shareEntry(${originalIndex})" class="small-share-btn" title="Share">â†—ï¸</button>
                    </div>
                </div>
            `;
        } else {
            // REGULAR JOURNAL OR PRACTICE ENTRY
            const isPractice = entry.type === 'practice';
            
            container.innerHTML += `
                <div class="journal-entry">
                    <div class="entry-date">
                        <span>${entry.date.split(',')[0]}</span>
                        <span style="${isPractice ? 'text-align: right;' : ''}">${isPractice ? 'ğŸ“¿ ' + entry.principle : 'ğŸ“– ' + (currentLanguage === 'en' ? 'Journal' : 'áƒ“áƒ¦áƒ˜áƒ£áƒ áƒ˜')}</span>
                    </div>
                    <p>${entry.text}</p>
                    <div class="entry-footer">
                        <button onclick="shareEntry(${originalIndex})" class="small-share-btn" title="Share">â†—ï¸</button>
                    </div>
                </div>
            `;
            
            if (entry.poem) {
                container.innerHTML += `
                    <div class="poem-response">
                        <p>${entry.poem.replace(/\n/g, '<br>')}</p>
                        <div class="sage-quote">${entry.sage}</div>
                        <div class="entry-footer">
                            <button onclick="shareEntry(${originalIndex}, true)" class="small-share-btn" title="Share Poem">â†—ï¸</button>
                        </div>
                    </div>
                `;
            }
        }
    });
    }

function shareEntry(entryIndex, sharePoemOnly = false) {
    const entry = myTree.journals[entryIndex];
    if (!entry) return;
    
    let shareText = '';
    
    if (sharePoemOnly && entry.poem) {
        // Share only the poem
        shareText = `${entry.poem}\n\n${entry.sage || ''}\n\n#ForestOfSupport #HealLikeATree`;
    } else if (entry.type === 'canopy') {
        // Share canopy entry
        shareText = `ğŸŒ¤ï¸ ${entry.principle || entry.title}\n\n${entry.text}\n\n${entry.offering || ''}\n\n#ForestOfSupport #CanopyWisdom`;
    } else if (entry.poem) {
        // Share journal entry with poem
        shareText = `${entry.text}\n\n${entry.poem}\n\n${entry.sage || ''}\n\n#ForestOfSupport #HealLikeATree`;
    } else {
        // Share regular journal entry
        shareText = `${entry.text}\n\n#ForestOfSupport #TreeJournal`;
    }
    
    // Try Web Share API
    if (navigator.share) {
        navigator.share({
            title: 'Forest of Support',
            text: shareText,
            url: window.location.href
        }).catch(err => {
            console.log('Share cancelled:', err);
            copyToClipboard(shareText);
        });
    } else {
        copyToClipboard(shareText);
    }
}

function copyToClipboard(text) {
    navigator.clipboard.writeText(text);
    alert(currentLanguage === 'ge' 
        ? 'ğŸ“‹ áƒ™áƒáƒáƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜áƒ!'
        : 'ğŸ“‹ Copied!');
}
        
        function clearJournal() {
            document.getElementById('newJournalEntry').value = "";
        }
        
        function updateForestCard() {
            const t = TEXT[currentLanguage];
            
            if (!myTree.name) {
                document.getElementById('treeNameDisplay').textContent = t.noTree;
                document.getElementById('treeAscii').textContent = t.plantToBegin;
                document.getElementById('progressText').textContent = "0/5";
                return;
            }
            
            document.getElementById('treeNameDisplay').textContent = myTree.name;
            
            // Show appropriate tree stage in current language
            const stageIndex = Math.min(myTree.stage - 1, treeStages[currentLanguage].length - 1);
            document.getElementById('treeAscii').textContent = treeStages[currentLanguage][stageIndex];
            
            // Update progress ring
            const progressPercent = (myTree.stage / 5) * 100;
            document.querySelector('.progress-ring').style.background = 
                `conic-gradient(#4a7c3f 0% ${progressPercent}%, #e8f5e8 ${progressPercent}% 100%)`;
            document.getElementById('progressText').textContent = `${myTree.stage}/5`;
            
            // Update stats
            document.getElementById('statRings').textContent = myTree.rings;
            document.getElementById('statStage').textContent = myTree.stage;
            document.getElementById('statJournals').textContent = myTree.journals.length;
            document.getElementById('statPoems').textContent = myTree.poemsReceived;

            // Show/hide canopy button based on rings
            const canopyBtn = document.getElementById('become-canopy-btn');
            if (canopyBtn) {
                if (myTree.rings >= 21 && myTree.name) {
                    canopyBtn.style.display = 'inline-block';
                } else {
                    canopyBtn.style.display = 'none';
                }
            } 
        }
        
        function updateDisplay() {
            updateForestCard();
        }
        
        function saveTree() {
            localStorage.setItem('forestTree', JSON.stringify(myTree));
        }

        
        function checkAppVersion() {
            const savedVersion = localStorage.getItem(VERSION_KEY);
            
            if (savedVersion !== APP_VERSION) {
                console.log(`ğŸŒ³ Updating from v${savedVersion || '1.0'} to v${APP_VERSION}`);
                
                // Ensure new properties exist
                myTree.lastPracticePrinciple = myTree.lastPracticePrinciple || null;
                myTree.poemUsage = myTree.poemUsage || {};
                myTree.shownPoemsByCategory = myTree.shownPoemsByCategory || {
                    rooting: [], bark: [], rings: [], release: [], reaching: [],
                    network: [], bending: [], shape: [], seasons: [], wholeness: [],
                    patience: [], presence: []
                };
                
                // Save new version
                localStorage.setItem(VERSION_KEY, APP_VERSION);
                saveTree();
                
                // Show update message if not first install
                if (savedVersion) {
                    setTimeout(() => {
                        // TEMPORARILY disable service worker notifications
                        // sessionStorage.setItem('suppressServiceWorkerUpdate', 'true');
                        const t = TEXT[currentLanguage];
                        const updateMsg = `ğŸŒ³ ${currentLanguage === 'en' ? 'Forest of Support Updated!' : 'áƒ›áƒ®áƒáƒ áƒ“áƒáƒ­áƒ”áƒ áƒ˜áƒ¡ áƒ¢áƒ§áƒ” áƒ’áƒáƒœáƒáƒ®áƒšáƒ“áƒ!'}\n\n${currentLanguage === 'en' ? 'Version' : 'áƒ•áƒ”áƒ áƒ¡áƒ˜áƒ'} ${APP_VERSION}:\nâ€¢ ${currentLanguage === 'en' ? 'Share button & Canopy' : 'áƒ’áƒáƒ–áƒ˜áƒáƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ¦áƒ˜áƒšáƒáƒ™áƒ˜ áƒ“áƒ áƒ¡áƒáƒ©áƒ áƒ“áƒ˜áƒšáƒáƒ‘áƒ”áƒšáƒ˜'}`;
                        if (confirm(updateMsg + `\n\n${currentLanguage === 'en' ? 'Show detailed update notes?' : 'áƒ’áƒáƒ›áƒáƒ©áƒœáƒ“áƒ”áƒ¡ áƒ“áƒ”áƒ¢áƒáƒšáƒ£áƒ áƒ˜ áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ˜áƒœáƒ¤áƒáƒ áƒ›áƒáƒªáƒ˜áƒ?'}`)) {
                            showCard('welcome');
                            document.getElementById('welcome').innerHTML += `
                                <div class="step" style="background: #f0f7f0; margin-top: 20px;">
                                    <h3>${t.updateTitle.replace('{version}', APP_VERSION)}</h3>
                                   <!-- <p>${t.updateNewPoem}</p>-->
                                    <ul style="padding-left: 20px; margin: 10px 0;">
                                        ${t.updateList}
                                    </ul>
                                    <p>${t.updatePreserved}</p>
                                </div>
                            `;
                        }
                        // alert(updateMsg); \n\n${t.updatePreserved}
                        // Re-enable after 10 seconds
                        /*setTimeout(() => {
                            sessionStorage.removeItem('suppressServiceWorkerUpdate');
                        }, 10000);*/
                    }, 2000);
                }
            }
        }
    </script>
    
    <script>

        // ==================== AMBIENT SOUND PLAYER ====================
 
    const audioManager = {
    audio: null,
    isPlaying: false,
    volume: 0.9, // 90% volume - subtle background
    audioFiles: {
        birds: 'https://files.catbox.moe/fw3nxk.mp3'
        
        // 'https://files.catbox.moe/n75sd5.mp3' cleared
        // 'https://files.catbox.moe/fw3nxk.mp3' ++volume
        // 'https://files.catbox.moe/dgid57.mp3' old
        // 'https://cdn.jsdelivr.net/gh/tree2026/Forest-of-support/birdsong.mp3'
        // 'https://cdn.pixabay.com/download/audio/2022/03/15/audio_45a3a2c8a9.mp3?filename=forest-with-small-birds-wind-rain-13223.mp3'
        // 'https://assets.mixkit.co/sfx/download/mixkit-forest-birds-1575.mp3'
        // 'https://tree2026.github.io/Forest-of-support/birdsong.mp3'
        // 'https://raw.githubusercontent.com/tree2026/Forest-of-support/main/birdsong.mp3'
        // birds: 'audio/forest-birdsong.mp3'
    },
    
    init() {
        // Create audio element
        this.audio = new Audio(this.audioFiles.birds);
        this.audio.loop = true;
        this.audio.volume = this.volume;
        this.audio.preload = 'auto';
        
        // Load saved preference
        const savedPref = localStorage.getItem('forestAudioPref');
        if (savedPref === 'playing') {
            setTimeout(() => this.toggle(), 1000); // Start after 1 sec delay
        }
        
        // Auto-pause when tab is hidden (better UX)
        document.addEventListener('visibilitychange', () => {
            if (document.hidden && this.isPlaying) {
                this.pause();
                // Will resume when tab becomes visible again
                this.shouldResume = true;
            } else if (this.shouldResume) {
                this.play();
                this.shouldResume = false;
            }
        });
    },
    
    toggle() {
        if (this.isPlaying) {
            this.pause();
        } else {
            this.play();
        }
    },
    
    play() {
        if (!this.audio) this.init();
        
        // Modern browsers require user interaction first
        const playPromise = this.audio.play();
        
        if (playPromise !== undefined) {
            playPromise.then(() => {
                this.isPlaying = true;
                this.updateUI();
                localStorage.setItem('forestAudioPref', 'playing');
            }).catch(error => {
                console.log('Audio play failed:', error);
                // Show user instruction if needed
                if (error.name === 'NotAllowedError') {
                    this.showPlayInstruction();
                }
            });
        }
    },
    
    pause() {
        if (this.audio) {
            this.audio.pause();
            this.isPlaying = false;
            this.updateUI();
            localStorage.setItem('forestAudioPref', 'paused');
        }
    },
    
    updateUI() {
        const button = document.getElementById('music-toggle');
        if (button) {
            if (this.isPlaying) {
                button.classList.add('playing');
                button.innerHTML = 'ğŸ”Š';
                button.title = currentLanguage === 'ge' ? 'áƒ®áƒ›áƒ˜áƒ¡ áƒ’áƒáƒ›áƒáƒ áƒ—áƒ•áƒ' : 'Mute ambient sounds';
            } else {
                button.classList.remove('playing');
                button.innerHTML = 'ğŸµ';
                button.title = currentLanguage === 'ge' ? 'áƒ®áƒ›áƒ˜áƒ¡ áƒ©áƒáƒ áƒ—áƒ•áƒ' : 'Play ambient sounds';
            }
        }
    },
    
    showPlayInstruction() {
        // Only show once per session
        if (!sessionStorage.getItem('audioInstructionShown')) {
            const msg = currentLanguage === 'ge' 
                ? 'áƒ®áƒ›áƒ˜áƒ¡ áƒ©áƒáƒ¡áƒáƒ áƒ—áƒáƒ•áƒáƒ“, áƒ“áƒáƒáƒ¬áƒ™áƒáƒáƒ£áƒœáƒ”áƒ— áƒ®áƒ›áƒ˜áƒ¡ áƒ¦áƒ˜áƒšáƒáƒ™áƒ–áƒ” ğŸŒ³\n(áƒ‘áƒ áƒáƒ£áƒ–áƒ”áƒ áƒ˜ áƒ›áƒáƒ˜áƒ—áƒ®áƒáƒ•áƒ¡ áƒœáƒ”áƒ‘áƒáƒ áƒ—áƒ•áƒáƒ¡)'
                : 'To play sounds, click the music button ğŸŒ³\n(Browser requires your permission)';
            
            alert(msg);
            sessionStorage.setItem('audioInstructionShown', 'true');
        }
    },
    
    setVolume(level) {
        this.volume = Math.max(0, Math.min(1, level));
        if (this.audio) {
            this.audio.volume = this.volume;
        }
    }
};

// Initialize when page loads
document.addEventListener('DOMContentLoaded', function() {
    // Add event listener to button
    const musicButton = document.getElementById('music-toggle');
    if (musicButton) {
        musicButton.addEventListener('click', () => audioManager.toggle());
    }
    
    // Initialize audio manager after a delay
    setTimeout(() => audioManager.init(), 500);
}); 

        
    // ==================== PWA SERVICE WORKER REGISTRATION ====================
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            // Use relative path (works for both local and GitHub Pages)
            const swPath = 'sw.js?v=' + APP_VERSION;
            
            navigator.serviceWorker.register(swPath)
                .then(function(registration) {
                    console.log('ğŸŒ³ ServiceWorker registered successfully:', registration.scope);
                    
                    // Check for updates immediately
                    registration.update();
                })
                .catch(function(err) {
                    console.log('ğŸŒ³ ServiceWorker registration failed:', err);
                });
        });
    }
    </script>
    
   <script> 
   // ==================== UNIFIED UPDATE HANDLER ====================
// Listen for service worker updates
if ('serviceWorker' in navigator) {
    // Listen for messages from service worker
    navigator.serviceWorker.addEventListener('message', event => {
        if (event.data && event.data.type === 'UPDATE_READY') {
            showUpdateNotification();
        }
    });
    
    // Check for waiting service worker on page load
    navigator.serviceWorker.ready.then(registration => {
        if (registration.waiting) {
            showUpdateNotification();
        }
        
        // Listen for new service worker installation
        registration.addEventListener('updatefound', () => {
            const newWorker = registration.installing;
            newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                    // New content is available
                    setTimeout(() => {
                        showUpdateNotification();
                    }, 3000);
                }
            });
        });
    });
    
    // Periodically check for updates
    setInterval(() => {
        navigator.serviceWorker.getRegistration().then(registration => {
            if (registration) {
                registration.update();
            }
        });
    }, 60 * 60 * 1000); // Check every hour
}

// Unified update notification function
function showUpdateNotification() {
    // Check if suppressed
    /*if (sessionStorage.getItem('suppressServiceWorkerUpdate')) {
        return;
    }*/
    // Prevent multiple notifications
    if (sessionStorage.getItem('updateNotificationShown')) {
        return;
    }
    
    const lang = currentLanguage === 'ge' ? 'ge' : 'en';
    const messages = {
        ge: {
            title: 'ğŸ”„ áƒáƒ®áƒáƒšáƒ˜ áƒ•áƒ”áƒ áƒ¡áƒ˜áƒ áƒ®áƒ”áƒšáƒ›áƒ˜áƒ¡áƒáƒ¬áƒ•áƒ“áƒáƒ›áƒ˜áƒ',
            message: 'áƒ’áƒáƒœáƒáƒáƒ®áƒšáƒ”áƒ‘áƒ— áƒ›áƒ®áƒáƒ áƒ“áƒáƒ­áƒ”áƒ áƒ˜áƒ¡ áƒ¢áƒ§áƒ”áƒ¡ áƒ£áƒáƒ®áƒšáƒ”áƒ¡áƒ˜ áƒ•áƒ”áƒ áƒ¡áƒ˜áƒ˜áƒ¡ áƒ›áƒ˜áƒ¡áƒáƒ¦áƒ”áƒ‘áƒáƒ“?',
            update: 'áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ',
            later: 'áƒ›áƒáƒ’áƒ•áƒ˜áƒáƒœáƒ”áƒ‘áƒ˜áƒ—'
        },
        en: {
            title: 'ğŸ”„ New Version Available',
            message: 'Update Forest of Support to get the latest version?',
            update: 'Update',
            later: 'Later'
        }
    };
    
    const msg = messages[lang];
    
    // Show after short delay (user experience)
    setTimeout(() => {
        if (confirm(msg.title + '\n\n' + msg.message)) {
            sessionStorage.setItem('updateNotificationShown', 'true');
            window.location.reload();
        } else {
            sessionStorage.setItem('updateNotificationShown', 'true');
            // Clear after 1 hour so they can be asked again
            setTimeout(() => {
                sessionStorage.removeItem('updateNotificationShown');
            }, 60 * 60 * 1000);
        }
    }, 1500);
}

// ========== PERIODIC UPDATE CHECKS offline

if ('serviceWorker' in navigator) {
    function checkForUpdates() {
        if (!navigator.onLine) return;
        
        navigator.serviceWorker.ready.then(registration => {
            registration.update();
            
            // Check if update is already waiting
            if (registration.waiting) {
                showUpdateNotification();
            }
        }).catch(err => {
            console.log('Update check failed:', err);
        });
    }
    
    // Check when app becomes visible/refocused
    document.addEventListener('visibilitychange', () => {
        if (!document.hidden) {
            setTimeout(checkForUpdates, 1000); 
        }
    });
    
    setInterval(checkForUpdates, 12 * 60 * 60 * 1000);
    setTimeout(checkForUpdates, 5000);
}
       
// Clear update flag on new session
window.addEventListener('beforeunload', () => {
    sessionStorage.removeItem('updateNotificationShown');
}); 
   
       // Add this function for app intall button
       let deferredInstallPrompt;

       window.addEventListener('beforeinstallprompt', (e) => {
           e.preventDefault();
           deferredInstallPrompt = e;
           document.getElementById('install-btn').style.display = 'inline-block';
       });

       function promptInstall() {
           if (deferredInstallPrompt) {
               deferredInstallPrompt.prompt();
               deferredInstallPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
                document.getElementById('install-btn').style.display = 'none';
                // alert('ğŸŒ³ Thank you for installing! Your healing forest is now with you always.');
                // Localized thank you message
                const thankYouMsg = currentLanguage === 'ge' 
                    ? 'ğŸŒ³ áƒ’áƒ›áƒáƒ“áƒšáƒáƒ‘áƒ—! áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ’áƒáƒ›áƒáƒ¯áƒáƒœáƒ¡áƒáƒ¦áƒ”áƒ‘áƒ”áƒšáƒ˜ áƒ¢áƒ§áƒ” áƒáƒ®áƒšáƒ áƒ§áƒáƒ•áƒ”áƒšáƒ—áƒ•áƒ˜áƒ¡ áƒ—áƒ¥áƒ•áƒ”áƒœáƒ—áƒáƒœ áƒáƒ áƒ˜áƒ¡.'
                    : 'ğŸŒ³ Thank you for installing! Your healing forest is now with you always.';
                alert(thankYouMsg);
            }
            deferredInstallPrompt = null;
        });
           }
       }
       
   </script>

</body> 
</html>
